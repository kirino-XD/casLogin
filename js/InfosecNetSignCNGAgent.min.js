var SendToIp="https://127.0.0.1:";var PortList=[63451,63455,63460,52100,52110,52150,43110,45130,47101];var m_StorePort=0;var m_SetTimeOut=6e4;var m_SM2IssuerCert="";var m_Async=true;var m_ListForm=[];var m_ListFile=[];var m_ListFormResponsed=[];var m_ListFileNameResponsed=[];var m_PlanTextConvertMode="\r\n";var m_CspName="";var SkfDeviceType=-1;var SkfUseDeviceNameAry=["&Provider=","&DevSN2Name=","&bDevSN="];var SkfUseDeviceInfoAry=["","",""];var SkfSetDeviceNameAry=["&Provider=","&Device=","&Application="];var SkfSetDeviceInfoAry=["","",""];var numCount=1;var strwebSignDLL="cW52Y2xodFxWZ2FKYHJUaWZsLWBpajUy";var strwebSignSKFDLL="cW52Y2xodFxWZ2FKYHJUaWZsUE9DKGNsbTU0MzIxMDc=";var strwebEnrollToolDLL="cW52Y2xodFxWZ2FKYHJCbnNtb2hRaWhsL2ZvaDEyMzQ=";var strwebEnrollRSADLL="cW52Y2xodFxWZ2FKYHJCbnNtb2hXVUYuZW5vMTAzMjU=";var strwebEnrollSM2CFCADLL="cW52Y2xodFxWZ2FKYHJCbnNtb2hWSzVDR0FCKmFqazE=";var strwebEnrollSM2SKFDLL="cW52Y2xodFxWZ2FKYHJCbnNtb2hWSzVTSkQtYGlqNTI=";var strWebExtendDllDLL="cW52Y2xodFxWZ2FBfXJibmVGb2grYmtsOTo7PD0-Pzg=";var strWebIsecDLL="cW52Y2xodFxWZ2FNdmNkRG1uLWBpajUy";function XDRInfosec(i){if(!window.XDomainRequest){return}var S=null;var e="";var o=(i.dataType||"").toLowerCase();S=new XDomainRequest;if(/^\d+$/.test(i.timeout)){S.timeout=i.timeout}S.ontimeout=function(){i.error(500,"timeout")};S.onload=function(){var e="Content-Length: "+S.responseText.length+"\r\nContent-Type: "+S.contentType;var t={code:200,message:"success"};var a={text:S.responseText};try{if(o==="html"||/text\/html/i.test(S.contentType)){a.html=S.responseText}else if(o==="json"||o!=="text"&&/\/json/i.test(S.contentType)){try{a.json=InfosecStr2json(S.responseText)}catch(e){t.code=500;t.message="parseerror"}}else if(o==="xml"||o!=="text"&&/\/xml/i.test(S.contentType)){var r=new ActiveXObject("Microsoft.XMLDOM");r.async=false;try{r.loadXML(S.responseText)}catch(e){r=undefined}if(!r||!r.documentElement||r.getElementsByTagName("parsererror").length){t.code=500;t.message="parseerror";throw"Invalid XML: "+S.responseText}a.xml=r}}catch(e){throw e}finally{if(t.code==200&&t.message=="success"){var n=InfosecStr2json(S.responseText);i.success(n)}else{i.error(t.code,"error",a)}}};S.onprogress=function(){};S.onerror=function(){i.error(500,"error",{text:S.responseText})};if(i.data){e=i.data}S.open(i.method,i.url);S.send(e)}function ajaxInfosec(e){if(window.XDomainRequest){XDRInfosec(e);return}var t={method:"GET",dataType:"json",url:"",data:"",async:true,cache:true,contentType:"application/x-www-form-urlencoded",success:function(){},error:function(){},custom:function(){},complete:function(){}};for(var a in e){t[a]=e[a]}if(typeof t.data==="object"){var r="";var n="";for(var a in t.data){n=t.data[a];if(t.data[a].indexOf("&")!==-1)n=t.data[a].replace(/&/g,escape("&"));if(a.indexOf("&")!==-1)a=a.replace(/&/g,escape("&"));r+=a+"="+n+"&"}t.data=r.substring(0,r.length-1)}t.method=t.method.toUpperCase();t.cache=t.cache?"":"&"+(new Date).getTime();if(t.method==="GET"&&(t.data||t.cache))t.url+="?"+t.data+t.cache;var i=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");i.open(t.method,t.url,t.async);i.setRequestHeader("Accept","application/json, text/javascript, */*; q=0.01");if(t.method==="GET")i.send(null);else{i.setRequestHeader("Content-type",t.contentType);i.send(t.data)}if(!t.async){if(i.readyState===4){if(i.status===200){var S;if(t.dataType==="json"){S=InfosecStr2json(i.responseText)}else{S=i.responseText}t.success.call(i,S)}else{t.error.call(i,i.responseText)}}}else{i.onreadystatechange=function(){if(i.readyState===4){if(i.status===200){var e;if(t.dataType==="json"){e=InfosecStr2json(i.responseText)}else{e=i.responseText}t.success.call(i,e)}else{t.error()}}}}}function GetPlanTextForConvertMode(e){var t=e;if(m_PlanTextConvertMode=="\r\n"){var a=t.search("\n");var r=t.search("\r");if(a-r!=1&&(a>=1&&r==-1)){t=t.replace(/\n/g,"\r\n")}return t}if(m_PlanTextConvertMode=="\n"){var a=t.search("\n");var r=t.search("\r");if(a-r==1&&(a>=1&&r>-1)){t=t.replace(/\r\n/g,"\n")}return t}return t}function BASE64URLEN(e){if(e==undefined){return""}var t=e;t=t.replace(/\+/g,"-");t=t.replace(/\//g,"_");return t}function BASE64URLDE(e){if(e==undefined){return""}var t=e;t=t.replace(/-/g,"+");t=t.replace(/_/g,"/");return t}function JointSendData(e,t){var a="";if(t.length!=e.length||t.length<0){return a}for(var r=0;r<t.length;r++){t[r]=encodeURIComponent(t[r]);t[r]=encodeURIComponent(t[r]);a=a+e[r];a=a+t[r]}return a}function JsonPlantextSpecialCharProcess(e){if(e==""||e==undefined){return""}e=decodeURIComponent(e);e=decodeURIComponent(e);return e}function GetPortForIE(){try{var e=new ActiveXObject("InfosecIWSAComPort.InfosecComPortMain.1");var t=e.GetPort();if(t<=0){return 0}m_StorePort=t;return t}catch(e){return 0}}function sendAjaxSniffingData(t){numCount=numCount+1;var e=SendToIp+t+"/PortRight"+"?randtmp="+numCount;var r=0;if(navigator.appName=="Microsoft Internet Explorer"){return GetPortForIE()}ajaxInfosec({url:e,method:"GET",timeout:100,data:"",async:false,dataType:"json",beforeSend:function(){},complete:function(e,t){},error:function(e,t,a){r=0;return},success:function(e){if(e[0].errorCode==0){r=t;return}else{r=0;return}}});return r}function sendAjaxSniffingDataAsync(t){numCount=numCount+1;var e=SendToIp+t+"/PortRight"+"?randtmp="+numCount;ajaxInfosec({url:e,method:"GET",timeout:100,data:"",async:true,dataType:"json",beforeSend:function(){},complete:function(e,t){},error:function(e,t,a){},success:function(e){if(e[0].errorCode==0){m_StorePort=t;return}}})}function PortIsRight(){for(var e=0;e<PortList.length;e++){if(m_StorePort==PortList[e]){return true}}return false}function GetRightPORT(){var e=0;m_StorePort=0;for(var t=0;t<PortList.length;t++){var a=sendAjaxSniffingData(PortList[t]);if(a>0){e=a;m_StorePort=e;break}}return e}function AddFormListFromResponse(e){if(e==""||e==undefined){return}e=JsonPlantextSpecialCharProcess(e);var t=InfosecStr2json(e);if(t.length<0){return}for(var a=0;a<t.length;a++){t[a].FormValue=JsonPlantextSpecialCharProcess(t[a].FormValue);m_ListFormResponsed.push(t[a].FormValue)}return}function AddFileNameListFileNameResponse(e){if(e==""||e==undefined){return}e=JsonPlantextSpecialCharProcess(e);var t=InfosecStr2json(e);if(t.length<0){return}for(var a=0;a<t.length;a++){t[a].FileNameValue=JsonPlantextSpecialCharProcess(t[a].FileNameValue);m_ListFileNameResponsed.push(t[a].FileNameValue)}return}function GetStringAryMagic(){var e=new Array;for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}return e}function JSCallbackGetVersion(e,t){var a="";if(e[0].Version==undefined){a=e}else{a=e[0].Version}if(t!=undefined){t(a);return}return a}function JSCallbackBase64Encode(e,t){var a=e[0].errorCode;var r=e[0].TextData;r=BASE64URLDE(r);if(t!=undefined){t(a,r);return}return GetStringAryMagic(a,r)}function JSCallbackBase64Decode(e,t){var a=e[0].TextData;a=JsonPlantextSpecialCharProcess(a);if(t!=undefined){t(e[0].errorCode,a);return}return GetStringAryMagic(e[0].errorCode,a)}function JSCallbackHashAndBase64Encode(e,t){var a=e[0].TextData;a=BASE64URLDE(a);if(t!=undefined){t(e[0].errorCode,a);return}return GetStringAryMagic(e[0].errorCode,a)}function JSCallbackNSSigned(e,t){var a=e[0].signedData;a=BASE64URLDE(a);if(t!=undefined){t(e[0].errorCode,a);return}return GetStringAryMagic(e[0].errorCode,a)}function JSCallbackErrorCode(e,t){if(t!=undefined){t(e[0].errorCode);return}return e[0].errorCode}function JSCallbackBigFileHash(e,t){var a=e[0].hashData;a=BASE64URLDE(a);if(t!=undefined){t(e[0].errorCode,a);return}return GetStringAryMagic(e[0].errorCode,a)}function JSCallbackSkfGetCertsListInfo(e,t){var a=0;for(a=0;a<e.length;a++){e[a].certDN=JsonPlantextSpecialCharProcess(e[a].certDN);e[a].issuerDN=JsonPlantextSpecialCharProcess(e[a].issuerDN);e[a].certSN=JsonPlantextSpecialCharProcess(e[a].certSN);e[a].validBegin=JsonPlantextSpecialCharProcess(e[a].validBegin);e[a].validEnd=JsonPlantextSpecialCharProcess(e[a].validEnd);e[a].CertStore=JsonPlantextSpecialCharProcess(e[a].CertStore);e[a].KeyUsage=JsonPlantextSpecialCharProcess(e[a].KeyUsage);e[a].CertType=JsonPlantextSpecialCharProcess(e[a].CertType)}return ReturnOnlyOneParameter(e,t)}function JSCallbackSkfGetFileNameList(e,t){var a=0;for(a=0;a<e.length;a++){e[a].FileName=JsonPlantextSpecialCharProcess(e[a].FileName)}return ReturnOnlyOneParameter(e,t)}function JSCallbackSkfGetFileInfoForIndex(e,t){e[0].FileName=JsonPlantextSpecialCharProcess(e[0].FileName);if(t!=undefined){t(e[0].errorCode,e[0].FileName,e[0].Filedata);return}return GetStringAryMagic(e[0].errorCode,e[0].FileName,e[0].Filedata);var a=0;for(a=0;a<e.length;a++){e[a].FileName=JsonPlantextSpecialCharProcess(e[a].FileName)}return ReturnOnlyOneParameter(e,t)}function JSCallbackSkfAttachedVerify(e,t){e[0].PlainText=JsonPlantextSpecialCharProcess(e[0].PlainText);e[0].Cert=JsonPlantextSpecialCharProcess(e[0].Cert);e[0].Cert=BASE64URLDE(e[0].Cert);e[0].certDN=JsonPlantextSpecialCharProcess(e[0].certDN);e[0].issuerDN=JsonPlantextSpecialCharProcess(e[0].issuerDN);e[0].certSN=JsonPlantextSpecialCharProcess(e[0].certSN);e[0].validBegin=JsonPlantextSpecialCharProcess(e[0].validBegin);e[0].validEnd=JsonPlantextSpecialCharProcess(e[0].validEnd);var a=e[0].certDN+" "+e[0].issuerDN+" "+e[0].certSN+" "+e[0].validBegin+" "+e[0].validEnd;if(t!=undefined){t(e[0].errorCode,e[0].PlainText,a,e[0].Cert);return}return GetStringAryMagic(e[0].errorCode,e[0].PlainText,e[0].CertInfo,e[0].Cert)}function JSCallbackSkfDetachedVerify(e,t){e[0].Cert=JsonPlantextSpecialCharProcess(e[0].Cert);e[0].Cert=BASE64URLDE(e[0].Cert);e[0].certDN=JsonPlantextSpecialCharProcess(e[0].certDN);e[0].issuerDN=JsonPlantextSpecialCharProcess(e[0].issuerDN);e[0].certSN=JsonPlantextSpecialCharProcess(e[0].certSN);e[0].validBegin=JsonPlantextSpecialCharProcess(e[0].validBegin);e[0].validEnd=JsonPlantextSpecialCharProcess(e[0].validEnd);var a=e[0].certDN+" "+e[0].issuerDN+" "+e[0].certSN+" "+e[0].validBegin+" "+e[0].validEnd;if(t!=undefined){t(e[0].errorCode,a,e[0].Cert);return}return GetStringAryMagic(e[0].errorCode,a,e[0].Cert)}function JSCallbackSkfEncryptedSignEnvelop(e,t){var a=JsonPlantextSpecialCharProcess(e[0].Data);a=BASE64URLDE(a);if(t!=undefined){t(e[0].errorCode,a);return}return GetStringAryMagic(e[0].errorCode,a)}function JSCallbackAttachedVerify(e,t){e[0].PlainText=JsonPlantextSpecialCharProcess(e[0].PlainText);e[0].SigncertDN=JsonPlantextSpecialCharProcess(e[0].SigncertDN);if(t!=undefined){t(e[0].errorCode,e[0].PlainText,e[0].SigncertDN);return}return GetStringAryMagic(e[0].errorCode,e[0].PlainText,e[0].SigncertDN)}function JSCallbackFormFileVerify(e,t){e[0].SigncertDN=JsonPlantextSpecialCharProcess(e[0].SigncertDN);AddFormListFromResponse(e[0].FormTotal);AddFileNameListFileNameResponse(e[0].FileNameTotal);if(t!=undefined){t(e[0].errorCode,e[0].SigncertDN);return}return GetStringAryMagic(e[0].errorCode,e[0].SigncertDN)}function JSCallbackEncryptedEnvelop(e,t){var a=e[0].envelopedMsg;a=BASE64URLDE(a);if(t!=undefined){t(e[0].errorCode,a);return}return GetStringAryMagic(e[0].errorCode,a)}function JSCallbackDecryptEnvelop(e,t){e[0].PlainText=JsonPlantextSpecialCharProcess(e[0].PlainText);e[0].EncryptcertDN=JsonPlantextSpecialCharProcess(e[0].EncryptcertDN);if(t!=undefined){t(e[0].errorCode,e[0].PlainText,e[0].EncryptcertDN);return}return GetStringAryMagic(e[0].errorCode,e[0].PlainText,e[0].EncryptcertDN)}function JSCallbackFormFileDecryptedEnvelop(e,t){e[0].EncryptcertDN=JsonPlantextSpecialCharProcess(e[0].EncryptcertDN);AddFormListFromResponse(e[0].FormTotal);AddFileNameListFileNameResponse(e[0].FileNameTotal);if(t!=undefined){t(e[0].errorCode,e[0].EncryptcertDN);return}return GetStringAryMagic(e[0].errorCode,e[0].EncryptcertDN)}function JSCallbackDecryptSignEnvelop(e,t){e[0].PlainText=JsonPlantextSpecialCharProcess(e[0].PlainText);e[0].SigncertDN=JsonPlantextSpecialCharProcess(e[0].SigncertDN);e[0].EncryptcertDN=JsonPlantextSpecialCharProcess(e[0].EncryptcertDN);if(t!=undefined){t(e[0].errorCode,e[0].PlainText,e[0].SigncertDN,e[0].EncryptcertDN);return}return GetStringAryMagic(e[0].errorCode,e[0].PlainText,e[0].SigncertDN,e[0].EncryptcertDN)}function JSCallbackFormFileDecryptedSignEnvelop(e,t){e[0].SigncertDN=JsonPlantextSpecialCharProcess(e[0].SigncertDN);e[0].EncryptcertDN=JsonPlantextSpecialCharProcess(e[0].EncryptcertDN);AddFormListFromResponse(e[0].FormTotal);AddFileNameListFileNameResponse(e[0].FileNameTotal);if(t!=undefined){t(e[0].errorCode,e[0].SigncertDN,e[0].EncryptcertDN);return}return GetStringAryMagic(e[0].errorCode,e[0].SigncertDN,e[0].EncryptcertDN)}function JSCallbackGetCertInfoForIndex(e,t){if(t!=undefined){t(e[0].CertInfoData);return}return e[0].CertInfoData}function JSCallbackGetCertPublicKeyInfoForIndex(e,t){if(t!=undefined){t(e[0].CertPublicKeyInfoData);return}return e[0].CertPublicKeyInfoData}function JSCallbackGetCertsListInfo(e,t){var a=0;for(a=0;a<e.length;a++){e[a].certDN=JsonPlantextSpecialCharProcess(e[a].certDN);e[a].issuerDN=JsonPlantextSpecialCharProcess(e[a].issuerDN);e[a].certSN=JsonPlantextSpecialCharProcess(e[a].certSN);e[a].validBegin=JsonPlantextSpecialCharProcess(e[a].validBegin);e[a].validEnd=JsonPlantextSpecialCharProcess(e[a].validEnd);e[a].CertStore=JsonPlantextSpecialCharProcess(e[a].CertStore);e[a].KeyUsage=JsonPlantextSpecialCharProcess(e[a].KeyUsage);e[a].CertType=JsonPlantextSpecialCharProcess(e[a].CertType)}return ReturnOnlyOneParameter(e,t)}function JSCallbackGetRsaCspListProvider(e,t){if(t!=undefined){t(e);return}return e}function JSCallbackSm2SkfGetDeviceList(e,t){for(var a=0;a<e.length;a++){e[a].Device=JsonPlantextSpecialCharProcess(e[a].Device)}if(t!=undefined){t(e);return}return e}function JSCallbackSm2SkfGetProviderList(e,t){for(var a=0;a<e.length;a++){e[a].Provider=JsonPlantextSpecialCharProcess(e[a].Provider)}if(t!=undefined){t(e);return}return e}function JSCallbackSm2SkfGetApplicationList(e,t){for(var a=0;a<e.length;a++){e[a].Application=JsonPlantextSpecialCharProcess(e[a].Application)}if(t!=undefined){t(e);return}return e}function JSCallbackSm2SkfGetContainerList(e,t){for(var a=0;a<e.length;a++){e[a].Container=JsonPlantextSpecialCharProcess(e[a].Container)}if(t!=undefined){t(e);return}return e}function JSCallbackGetCountOfCert(e,t){if(t!=undefined){t(e[0].CertCount);return}return e[0].CertCount}function JSCallbackGetRsaCspCertInfo(e,t){e[0].Provider=JsonPlantextSpecialCharProcess(e[0].Provider);e[0].Container=JsonPlantextSpecialCharProcess(e[0].Container);e[0].DN=JsonPlantextSpecialCharProcess(e[0].DN);e[0].Issuer=JsonPlantextSpecialCharProcess(e[0].Issuer);e[0].StartDate=JsonPlantextSpecialCharProcess(e[0].StartDate);e[0].EndDate=JsonPlantextSpecialCharProcess(e[0].EndDate);e[0].CertSN=JsonPlantextSpecialCharProcess(e[0].CertSN);e[0].CertPurpose=JsonPlantextSpecialCharProcess(e[0].CertPurpose);if(t!=undefined){t(e[0].errorCode,e[0].Provider,e[0].Container,e[0].DN,e[0].Issuer,e[0].StartDate,e[0].EndDate,e[0].CertSN,e[0].CertPurpose);return}return GetStringAryMagic(e[0].errorCode,e[0].Provider,e[0].Container,e[0].DN,e[0].Issuer,e[0].StartDate,e[0].EndDate,e[0].CertSN,e[0].CertPurpose)}function JSCallbackSm2SkfGetCertInfo(e,t){e[0].Provider=JsonPlantextSpecialCharProcess(e[0].Provider);e[0].Device=JsonPlantextSpecialCharProcess(e[0].Device);e[0].DeviceSN=JsonPlantextSpecialCharProcess(e[0].DeviceSN);e[0].application=JsonPlantextSpecialCharProcess(e[0].application);e[0].Container=JsonPlantextSpecialCharProcess(e[0].Container);e[0].DN=JsonPlantextSpecialCharProcess(e[0].DN);e[0].Issuer=JsonPlantextSpecialCharProcess(e[0].Issuer);e[0].StartDate=JsonPlantextSpecialCharProcess(e[0].StartDate);e[0].EndDate=JsonPlantextSpecialCharProcess(e[0].EndDate);e[0].CertSN=JsonPlantextSpecialCharProcess(e[0].CertSN);e[0].CertPurpose=JsonPlantextSpecialCharProcess(e[0].CertPurpose);if(t!=undefined){t(e[0].errorCode,e[0].Provider,e[0].Device,e[0].DeviceSN,e[0].application,e[0].Container,e[0].DN,e[0].Issuer,e[0].StartDate,e[0].EndDate,e[0].CertSN,e[0].CertPurpose);return}return GetStringAryMagic(e[0].errorCode,e[0].Provider,e[0].Device,e[0].DeviceSN,e[0].application,e[0].Container,e[0].DN,e[0].Issuer,e[0].StartDate,e[0].EndDate,e[0].CertSN,e[0].CertPurpose)}function JSCallbackAdvRsaCspGenContainerP10(e,t){if(t!=undefined){t(e[0].errorCode,e[0].P10Value,e[0].EncKeyPair);return}return GetStringAryMagic(e[0].errorCode,e[0].P10Value,e[0].EncKeyPair)}function JSCallbackRsaCspGenContainer(e,t){if(t!=undefined){t(e[0].errorCode,e[0].Container);return}return GetStringAryMagic(e[0].errorCode,e[0].Container)}function JSCallbackGetDataParem(e,t){if(t!=undefined){t(e[0].errorCode,e[0].Data);return}return GetStringAryMagic(e[0].errorCode,e[0].Data)}function JSCallbackSm2SkfReadData(e,t){e[0].Data=JsonPlantextSpecialCharProcess(e[0].Data);if(t!=undefined){t(e[0].errorCode,e[0].Data);return}return GetStringAryMagic(e[0].errorCode,e[0].Data)}function JSCallbackRsaCspGenContainerP10(e,t){if(t!=undefined){t(e[0].errorCode,e[0].Container,e[0].P10);return}return GetStringAryMagic(e[0].errorCode,e[0].Container,e[0].P10)}function JSCallbackGetRsaCertStore(e,t){return ReturnOnlyOneParameter(e[0].CertStore,t)}function JSCallbackGetDistinctNameKeyValuePairNumber(e,t){return ReturnOnlyOneParameter(e[0].Count,t)}function JSCallbackGetDistinctNameKeyValuePair(e,t){e[0].Key=JsonPlantextSpecialCharProcess(e[0].Key);e[0].Value=JsonPlantextSpecialCharProcess(e[0].Value);if(t!=undefined){t(e[0].errorCode,e[0].Key,e[0].Value);return}return GetStringAryMagic(e[0].errorCode,e[0].Key,e[0].Value)}function JSCallbackCompareCertTime(e,t){return ReturnOnlyOneParameter(e[0].RetResult,t)}function JSCallbackGetX509CertInfo(e,t){e[0].DN=JsonPlantextSpecialCharProcess(e[0].DN);e[0].Issuer=JsonPlantextSpecialCharProcess(e[0].Issuer);e[0].StartDate=JsonPlantextSpecialCharProcess(e[0].StartDate);e[0].EndDate=JsonPlantextSpecialCharProcess(e[0].EndDate);e[0].CertSN=JsonPlantextSpecialCharProcess(e[0].CertSN);e[0].CertPurpose=JsonPlantextSpecialCharProcess(e[0].CertPurpose);if(t!=undefined){t(e[0].errorCode,e[0].DN,e[0].Issuer,e[0].StartDate,e[0].EndDate,e[0].CertSN,e[0].CertPurpose);return}return GetStringAryMagic(e[0].errorCode,e[0].DN,e[0].Issuer,e[0].StartDate,e[0].EndDate,e[0].CertSN,e[0].CertPurpose)}function JSCallbackSm2CfcaGenContainerP10Encpubkey(e,t){if(t!=undefined){t(e[0].errorCode,e[0].Container,e[0].P10,e[0].Pubkey);return}return GetStringAryMagic(e[0].errorCode,e[0].Container,e[0].P10,e[0].Pubkey)}function JSCallbackSm2CfcaGenP10Encpubkey(e,t){if(t!=undefined){t(e[0].errorCode,e[0].P10,e[0].Pubkey);return}return GetStringAryMagic(e[0].errorCode,e[0].P10,e[0].Pubkey)}function JSCallbackSm2SkfGetDeviceInfo(e,t){if(t!=undefined){t(e[0].errorCode,e[0].SN,e[0].Lable);return}return GetStringAryMagic(e[0].errorCode,e[0].SN,e[0].Lable)}function JSCallbackSm2SkfGetPinInfo(e,t){if(t!=undefined){t(e[0].errorCode,e[0].MaxNum,e[0].NowSurplusNum);return}return GetStringAryMagic(e[0].errorCode,e[0].MaxNum,e[0].NowSurplusNum)}function JSCallbackMAuthSDKGetBASE64URLData(e,t){var a=e[0].Data;a=BASE64URLDE(a);if(t!=undefined){t(e[0].errorCode,a);return}return GetStringAryMagic(e[0].errorCode,a)}function JSCallbackCallDLLFunction(e,t){e[0].Data=JsonPlantextSpecialCharProcess(e[0].Data);if(t!=undefined){t(e[0].errorCode,e[0].Data);return}return GetStringAryMagic(e[0].errorCode,e[0].Data)}function JSCallbackGetLicenseTime(e,t){if(t!=undefined){t(e[0].errorCode,e[0].EXPTIME);return}return GetStringAryMagic(e[0].errorCode,e[0].EXPTIME)}function JSCallbackGetCookieCount(e,t){if(t!=undefined){t(e[0].Data);return}return e[0].Data}function ReturnOnlyOneParameter(e,t){if(t!=undefined){t(e);return}return e}function sendAjaxData(e,t,a,r,n){numCount=numCount+1;var i;if(PortIsRight()==false){GetRightPORT()}if(PortIsRight()==false){return i}var S=SendToIp+m_StorePort+"/"+e+"?randtmp="+numCount;ajaxInfosec({url:S,method:t,data:a,async:m_Async,dataType:"json",beforeSend:function(){},complete:function(e,t){},error:function(e,t,a){if(m_Async==true){}},success:function(e){i=n(e,r)},timeout:m_SetTimeOut});return i}function GetDigestArithmeticByName(e){if(e=="SM3"){return"1.2.156.10197.1.401"}if(e=="SHA1"){return"1.3.14.3.2.26"}if(e=="MD5"){return"1.2.840.113549.2.5"}if(e=="SHA256"){return"2.16.840.1.101.3.4.2.1"}if(e=="SHA384"){return"2.16.840.1.101.3.4.2.2"}if(e=="SHA512"){return"2.16.840.1.101.3.4.2.3"}return""}function GetSymmetryArithmeticByName(e){if(e=="RC4"){return"1.2.840.113549.3.4"}if(e=="3DES"){return"1.2.840.113549.3.7"}if(e=="RC2"){return"1.2.840.113549.3.2"}if(e=="DES"){return"1.3.14.3.2.7"}return""}function InfosecGetCertStoreName(e,t){var a="";if(t=="SignAndEncrypt"){a="MY,ROOT,CA,AddressBook"}if(t=="Encrypt"){a="ROOT,CA,AddressBook"}if(t=="Sign"){a="MY"}if(e==""||e==undefined){return a}else{if(a!=""){e=e+",";e=e+a}}return e}function PrefixInteger(e,t){return(Array(t).join(0)+e).slice(-t)}function mbStringLength(e){var t=0;var a;var r;for(a=0;a<e.length;a++){r=e.charCodeAt(a);if(r<127){t=t+1}else if(128<=r&&r<=2047){t+=2}else if(2048<=r&&r<=65535){t+=3}else if(65536<=r&&r<=2097151){t+=4}else if(2097152<=r&&r<=67108863){t+=5}else if(67108864<=r&&r<=2147483647){t+=6}}return t}function GetSendFormFilePlantText(){var e="";for(var t=0;t<m_ListForm.length;t++){e+="01";var a=mbStringLength(m_ListForm[t]);e+=PrefixInteger(a,31);e+=m_ListForm[t]}for(var t=0;t<m_ListFile.length;t++){e+="02";var a=mbStringLength(m_ListFile[t]);e+=PrefixInteger(a,31);e+=m_ListFile[t]}return e}function AttachedSignVerify(e,t,a,r,n){a=BASE64URLEN(a);var i=["mypluginName=","&PortGrade=","&signedMsg="];var S=[strwebSignDLL,t,a];if(t==1){i=["mypluginName=","&PortGrade=","&signedMsg="];S=[strwebSignDLL,t,a]}if(t==2){m_SM2IssuerCert=BASE64URLEN(m_SM2IssuerCert);i=["mypluginName=","&PortGrade=","&signedMsg=","&SM2IssuerCert="];S=[strwebSignDLL,t,a,m_SM2IssuerCert]}var o=JointSendData(i,S);return sendAjaxData(e,"POST",o,r,n)}function DecryptEnvelop(e,t,a,r){t=BASE64URLEN(t);var n=["mypluginName=","&envelopedMsg="];var i=[strwebSignDLL,t];var S=JointSendData(n,i);return sendAjaxData(e,"POST",S,a,r)}function DecryptSignEnvelop(e,t,a,r){t=BASE64URLEN(t);var n=["mypluginName=","&envelopedMsg="];var i=[strwebSignDLL,t];var S=JointSendData(n,i);return sendAjaxData(e,"POST",S,a,r)}function clearResponsedList(){m_ListFormResponsed=[];m_ListFileNameResponsed=[]}function GetAllreadyDeviceName(){var e=["SkfDeviceType=","&Null=","&Null=","&Null=","&mypluginName="];if(SkfDeviceType==1){e[1]=SkfUseDeviceNameAry[0];e[2]=SkfUseDeviceNameAry[1];e[3]=SkfUseDeviceNameAry[2]}if(SkfDeviceType==2){e[1]=SkfSetDeviceNameAry[0];e[2]=SkfSetDeviceNameAry[1];e[3]=SkfSetDeviceNameAry[2]}return e}function GetAllreadyDeviceInfo(){var e=["","","","",strwebEnrollSM2SKFDLL];e[0]=SkfDeviceType;if(SkfDeviceType==1){e[1]=SkfUseDeviceInfoAry[0];e[2]=SkfUseDeviceInfoAry[1];e[3]=SkfUseDeviceInfoAry[2]}if(SkfDeviceType==2){e[1]=SkfSetDeviceInfoAry[0];e[2]=SkfSetDeviceInfoAry[1];e[3]=SkfSetDeviceInfoAry[2]}return e}function GetSkfTitleParameterAndAllreadyDevice(){var e=new Array;var t=GetAllreadyDeviceName();for(var a=0;a<t.length;a++){e[a]=t[a]}var r=t.length;var n="";for(var i=0;i<arguments.length;i++){n="&";n=n+arguments[i];n=n+"=";e[r+i]=n}return e}function GetSkfDataParameterAndAllreadyDevice(){var e=new Array;var t=GetAllreadyDeviceInfo();for(var a=0;a<t.length;a++){e[a]=t[a]}var r=t.length;for(var n=0;n<arguments.length;n++){e[r+n]=arguments[n]}return e}function InfosecStr2json(a){if(a=="Copyright Infosec Technologies Co., Ltd."){return a}var t=/[\{\[\"ntf\d\.]/,r=0,n=a.length;function i(){var e=D(t);if(!e)return;switch(e){case"{":return S();case"[":return o();case"t":return l();case"f":return s();case"n":return c();case'"':return u()}return d(e)}function S(){var e=new Object;while(r<n){var t=D(/\S/);if(t=="}")break;if(t==",")continue;var a=u();D(/\:/);e[a]=i()}return e}function o(){var e=new Array;while(r<n){var t=D(/\S/);if(t=="]")break;if(t==",")continue;r--;e.push(i())}return e}function l(){r+=3;return true}function s(){r+=4;return false}function c(){r+=3;return null}function u(){var e=new Array;while(r<n){var t=a.charAt(r++);if(t=='"')break;if(t=="\\")t=C(a.charAt(r++));e.push(t)}return e.join("")}function d(e){while(r<n){var t=a.charAt(r++);if(!/[\d\.]/.test(t))break;e+=t}r--;return e-0}function D(e){while(r<n){var t=a.charAt(r++);if(e.test(t))return t}return""}var m={t:"\t",n:"\n",r:"\r",b:"\b",f:"\f",v:"\v"};function C(e){switch(e){case"x":return unescape("%"+a.slice(r,r+=2));case"u":return unescape("%u"+a.slice(r,r+=4))}return e in m?m[e]:e}return i()}function tojson(a){switch(typeof a){case"string":return e();case"number":return t();case"object":return n(a);case"boolean":return r();case"date":return S();case"function":return a;case"undefined":return'"undefined"';default:return"unknown"}function e(){return'"'+a.replace(/[\"\\]/g,function(e){return"\\"+e}).replace(/\r/g,"\\r").replace(/\n/g,"\\n")+'"'}function t(){return a}function r(){return a?"true":"false"}function n(){if(!a)return"null";if(a instanceof Array)return i();var e=new Array;for(var t in a)e.push(tojson(t+"")+":"+tojson(a[t]));return"{"+e.join(",")+"}"}function i(){var e=new Array;for(var t=0;t<a.length;t++)e.push(tojson(a[t]));return"["+e.join(",")+"]"}function S(){var e=new Date(a-0);var t=e.getFullYear()+"-";t+=o(e.getMonth()+1)+"-";t+=o(e.getDate())+" ";t+=o(e.getHours())+":";t+=o(e.getMinutes())+":";t+=o(e.getSeconds());return'"'+t+'"'}function o(e){return e<10?"0"+e:e}}function IWSAgent(){var e=new Object;e.IWSASendAvailable=function(){m_StorePort=0;if(navigator.appName=="Microsoft Internet Explorer"){return GetPortForIE()}for(var e=0;e<PortList.length;e++){try{m_ret=sendAjaxSniffingDataAsync(PortList[e])}catch(e){}}};e.IWSAGetAvailable=function(){return PortIsRight()};e.IWSAAvailable=function(){for(var e=0;e<PortList.length;e++){var t=0;try{t=sendAjaxSniffingData(PortList[e])}catch(e){}if(t!=0){m_StorePort=t;return true}}return false};e.IWSASetAsyncMode=function(e){m_Async=e;return};e.IWSAGetAsyncMode=function(){return m_Async};e.IWSASetTimeOut=function(e){m_SetTimeOut=e;return};e.IWSASetPlanTextConvertMode=function(e){m_PlanTextConvertMode=e;return};e.IWSASetSM2IssuerCert=function(e){m_SM2IssuerCert=e;return};e.IWSAGetVersion=function(e){return sendAjaxData("GetFrameVersion","GET","",e,JSCallbackGetVersion)};e.IWSADLLGetVersion=function(e,t,a){var r="mypluginName="+e;return sendAjaxData(t,"GET",r,a,JSCallbackGetVersion)};e.IWSABase64Encode=function(e,t){if(e!=""){e=GetPlanTextForConvertMode(e)}var a=["mypluginName=","&PlainText="];var r=[strwebSignDLL,e];var n=JointSendData(a,r);return sendAjaxData("NSBase64Encode","POST",n,t,JSCallbackBase64Encode)};e.IWSABase64Decode=function(e,t){e=BASE64URLEN(e);var a=["mypluginName=","&PlainText="];var r=[strwebSignDLL,e];var n=JointSendData(a,r);return sendAjaxData("NSBase64Decode","POST",n,t,JSCallbackBase64Decode)};e.IWSAHashAndBase64Encode=function(e,t,a){t=GetDigestArithmeticByName(t);if(e!=""){e=GetPlanTextForConvertMode(e)}var r=["mypluginName=","&PlainText=","&DigestArithmetic="];var n=[strwebSignDLL,e,t];var i=JointSendData(r,n);return sendAjaxData("NSHashAndBase64Encode","POST",i,a,JSCallbackHashAndBase64Encode)};e.IWSASignHash=function(e,t,a,r){a=GetDigestArithmeticByName(a);if(e!=""){e=GetPlanTextForConvertMode(e)}var n=["mypluginName=","&PlainText=","&CertIndex=","&DigestArithmetic="];var i=[strwebSignDLL,e,t,a];var S=JointSendData(n,i);return sendAjaxData("NSSignHash","POST",S,r,JSCallbackNSSigned)};e.IWSAVerifyHash=function(e,t,a){e=BASE64URLEN(e);if(t!=""){t=GetPlanTextForConvertMode(t)}var r=["mypluginName=","&signedMsg=","&PlainText="];var n=[strwebSignDLL,e,t];var i=JointSendData(r,n);return sendAjaxData("NSVerifyHash","POST",i,a,JSCallbackErrorCode)};e.IWSASKFSM2SignHash=function(e,t,a,r,n){r=GetDigestArithmeticByName(r);e=BASE64URLEN(e);if(e!=""){e=GetPlanTextForConvertMode(e)}var i=["mypluginName=","&HashValue=","&CertIndex=","&UsbKeyPin=","&DigestArithmetic="];var S=[strwebSignSKFDLL,e,t,a,r];var o=JointSendData(i,S);return sendAjaxData("NSSKFSM2SignHash","POST",o,n,JSCallbackNSSigned)};e.IWSASKFSM2VerifyHash=function(e,t,a){e=BASE64URLEN(e);t=BASE64URLEN(t);var r=["mypluginName=","&signedMsg=","&HashValue="];var n=[strwebSignSKFDLL,e,t];var i=JointSendData(r,n);return sendAjaxData("NSSKFSM2VerifyHash","POST",i,a,JSCallbackErrorCode)};e.IWSADetachedSign=function(e,t,a,r,n){r=GetDigestArithmeticByName(r);if(t!=""){t=GetPlanTextForConvertMode(t)}var i=["mypluginName=","&PortGrade=","&PlainText=","&CertIndex=","&DigestArithmetic="];var S=[strwebSignDLL,e,t,a,r];var o=JointSendData(i,S);return sendAjaxData("NSDetachedSign","POST",o,n,JSCallbackNSSigned)};e.IWSADetachedVerify=function(e,t,a,r){t=BASE64URLEN(t);if(a!=""){a=GetPlanTextForConvertMode(a)}var n=["mypluginName=","&PortGrade=","&signedMsg=","&PlainText=","&SM2IssuerCert="];var i=["","","","",""];if(e==1){n=["mypluginName=","&PortGrade=","&signedMsg=","&PlainText="];i=[strwebSignDLL,e,t,a]}if(e==2){m_SM2IssuerCert=BASE64URLEN(m_SM2IssuerCert);n=["mypluginName=","&PortGrade=","&signedMsg=","&PlainText=","&SM2IssuerCert="];i=[strwebSignDLL,e,t,a,m_SM2IssuerCert]}var S=JointSendData(n,i);return sendAjaxData("NSDetachedVerify","POST",S,r,JSCallbackErrorCode)};e.IWSAAttachedSign=function(e,t,a,r,n){r=GetDigestArithmeticByName(r);if(t!=""){t=GetPlanTextForConvertMode(t)}var i=["mypluginName=","&PortGrade=","&PlainText=","&CertIndex=","&DigestArithmetic="];var S=[strwebSignDLL,e,t,a,r];var o=JointSendData(i,S);return sendAjaxData("NSAttachedSign","POST",o,n,JSCallbackNSSigned)};e.IWSAAttachedSignDefaultDN=function(e,t,a,r,n){r=GetDigestArithmeticByName(r);if(e!=""){e=GetPlanTextForConvertMode(e)}var i=InfosecGetCertStoreName("","Sign");var S="";if(a=="1"){S="2"}if(a=="0"){S="0"}var o=["mypluginName=","&PortGrade=","&PlainText=","&CertStore=","&defultDN=","&Keyspec=","&DigestArithmetic="];var l=[strwebSignDLL,1,e,i,t,S,r];var s=JointSendData(o,l);return sendAjaxData("NSAttachedSignDefaultDN","POST",s,n,JSCallbackNSSigned)};e.IWSAAttachedSignAdvDefaultDN=function(e,t,a,r,n,i,S){i=GetDigestArithmeticByName(i);if(e!=""){e=GetPlanTextForConvertMode(e)}var o=InfosecGetCertStoreName("","Sign");var l="";if(n=="1"){l="2"}if(n=="0"){l="0"}var s=["mypluginName=","&PortGrade=","&PlainText=","&CertStore=","&CertStoreSM2=","&CertStoreType=","&defultDN=","&Keyspec=","&DigestArithmetic="];var c=[strwebSignDLL,2,e,o,t,a,r,l,i];var u=JointSendData(s,c);return sendAjaxData("NSAttachedSignDefaultDN","POST",u,S,JSCallbackNSSigned)};e.IWSADetachedSignDefaultDN=function(e,t,a,r,n){r=GetDigestArithmeticByName(r);if(e!=""){e=GetPlanTextForConvertMode(e)}var i=InfosecGetCertStoreName("","Sign");var S="";if(a=="1"){S="2"}if(a=="0"){S="0"}var o=["mypluginName=","&PortGrade=","&PlainText=","&CertStore=","&defultDN=","&Keyspec=","&DigestArithmetic="];var l=[strwebSignDLL,1,e,i,t,S,r];var s=JointSendData(o,l);return sendAjaxData("NSDetachedSignDefaultDN","POST",s,n,JSCallbackNSSigned)};e.IWSADetachedSignAdvDefaultDN=function(e,t,a,r,n,i,S){i=GetDigestArithmeticByName(i);if(e!=""){e=GetPlanTextForConvertMode(e)}var o=InfosecGetCertStoreName("","Sign");var l="";if(n=="1"){l="2"}if(n=="0"){l="0"}var s=["mypluginName=","&PortGrade=","&PlainText=","&CertStore=","&CertStoreSM2=","&CertStoreType=","&defultDN=","&Keyspec=","&DigestArithmetic="];var c=[strwebSignDLL,2,e,o,t,a,r,l,i];var u=JointSendData(s,c);return sendAjaxData("NSDetachedSignDefaultDN","POST",u,S,JSCallbackNSSigned)};e.IWSAAttachedVerify=function(e,t,a){return AttachedSignVerify("NSAttachedVerify",e,t,a,JSCallbackAttachedVerify)};e.IWSARawSign=function(e,t,a,r){a=GetDigestArithmeticByName(a);if(e!=""){e=GetPlanTextForConvertMode(e)}var n=["mypluginName=","&PlainText=","&CertIndex=","&DigestArithmetic="];var i=[strwebSignDLL,e,t,a];var S=JointSendData(n,i);return sendAjaxData("NSRawSign","POST",S,r,JSCallbackNSSigned)};e.IWSARawSignDefaultDN=function(e,t,a,r,n){r=GetDigestArithmeticByName(r);if(e!=""){e=GetPlanTextForConvertMode(e)}var i=InfosecGetCertStoreName("","Sign");var S="";if(a=="1"){S="2"}if(a=="0"){S="0"}var o=["mypluginName=","&PlainText=","&CertStore=","&defultDN=","&Keyspec=","&DigestArithmetic="];var l=[strwebSignDLL,e,i,t,S,r];var s=JointSendData(o,l);return sendAjaxData("NSRawSignDefaultDN","POST",s,n,JSCallbackNSSigned)};e.IWSARawVerifyDefaultDN=function(e,t,a,r,n){r=GetDigestArithmeticByName(r);if(e!=""){e=GetPlanTextForConvertMode(e)}t=BASE64URLEN(t);var i=InfosecGetCertStoreName("","Encrypt");var S=["mypluginName=","&PlainText=","&signedMsg=","&CertStore=","&defultDN=","&DigestArithmetic="];var o=[strwebSignDLL,e,t,i,a,r];var l=JointSendData(S,o);return sendAjaxData("NSRawVerifyDefaultDN","POST",l,n,JSCallbackErrorCode)};e.IWSARawVerify=function(e,t,a,r,n){r=GetDigestArithmeticByName(r);if(e!=""){e=GetPlanTextForConvertMode(e)}t=BASE64URLEN(t);var i=["mypluginName=","&PlainText=","&signedMsg=","&CertIndex=","&DigestArithmetic="];var S=[strwebSignDLL,e,t,a,r];var o=JointSendData(i,S);return sendAjaxData("NSRawVerify","POST",o,n,JSCallbackErrorCode)};e.IWSAAddForm=function(e){if(e!=""){e=GetPlanTextForConvertMode(e)}m_ListForm.push(e);return};e.IWSAAddFile=function(e){m_ListFile.push(e);return};e.IWSAClearFormList=function(){m_ListForm=[];return};e.IWSAClearFileList=function(){m_ListFile=[];return};e.IWSAGetAlreadyFormList=function(){return m_ListForm};e.IWSAGetAlreadyFileList=function(){return m_ListFile};e.IWSAGetResponsedForm=function(){var e="";if(m_ListFormResponsed.length>0){e=m_ListFormResponsed[0];m_ListFormResponsed=m_ListFormResponsed.slice(1)}return e};e.IWSAGetResponsedFileName=function(){var e="";if(m_ListFileNameResponsed.length>0){e=m_ListFileNameResponsed[0]}return e};e.IWSAGetResponsedFile=function(e,t){var a="";if(m_ListFileNameResponsed.length>0){a=m_ListFileNameResponsed[0];m_ListFileNameResponsed=m_ListFileNameResponsed.slice(1)}var r=["mypluginName=","&FileName=","&FilePathName="];var n=[strwebSignDLL,a,e];var i=JointSendData(r,n);return sendAjaxData("NSFormFileGetFile","POST",i,t,JSCallbackErrorCode)};e.IWSAFormFileSign=function(e,t,a){var r=GetSendFormFilePlantText();t=GetDigestArithmeticByName(t);var n=["mypluginName=","&PortGrade=","&PlainText=","&CertIndex=","&DigestArithmetic="];var i=[strwebSignDLL,"2",r,e,t];var S=JointSendData(n,i);return sendAjaxData("NSFormFileSign","POST",S,a,JSCallbackNSSigned)};e.IWSAFormFileSignDefaultDN=function(e,t,a,r,n,i){var S=GetSendFormFilePlantText();n=GetDigestArithmeticByName(n);var o=InfosecGetCertStoreName("","Sign");var l="";if(r=="1"){l="2"}if(r=="0"){l="0"}var s=["mypluginName=","&PortGrade=","&PlainText=","&CertStore=","&CertStoreSM2=","&CertStoreType=","&defultDN=","&Keyspec=","&DigestArithmetic="];var c=[strwebSignDLL,2,S,o,e,t,a,l,n];var u=JointSendData(s,c);return sendAjaxData("NSFormFileSignDefaultDN","POST",u,i,JSCallbackNSSigned)};e.IWSAFormFileVerify=function(e,t){clearResponsedList();return AttachedSignVerify("NSFormFileVerify","2",e,t,JSCallbackFormFileVerify)};e.IWSAEncryptedEnvelop=function(e,t,a,r){a=GetSymmetryArithmeticByName(a);if(e!=""){e=GetPlanTextForConvertMode(e)}var n=["mypluginName=","&PlainText=","&CertIndex=","&SymmetryArithmetic="];var i=[strwebSignDLL,e,t,a];var S=JointSendData(n,i);return sendAjaxData("NSEncryptedEnvelop","POST",S,r,JSCallbackEncryptedEnvelop)};e.IWSAEncryptedEnvelopDefaultDN=function(e,t,a,r){a=GetSymmetryArithmeticByName(a);if(e!=""){e=GetPlanTextForConvertMode(e)}var n=InfosecGetCertStoreName("","Encrypt");var i=["mypluginName=","&PlainText=","&CertStore=","&defultDN=","&SymmetryArithmetic="];var S=[strwebSignDLL,e,n,t,a];var o=JointSendData(i,S);return sendAjaxData("NSEncryptedEnvelopDefaultDN","POST",o,r,JSCallbackEncryptedEnvelop)};e.IWSADecryptEnvelop=function(e,t){return DecryptEnvelop("NSDecryptEnvelop",e,t,JSCallbackDecryptEnvelop)};e.IWSAFormFileEncryptedEnvelop=function(e,t,a){var r=GetSendFormFilePlantText();t=GetSymmetryArithmeticByName(t);var n=["mypluginName=","&PlainText=","&CertIndex=","&SymmetryArithmetic="];var i=[strwebSignDLL,r,e,t];var S=JointSendData(n,i);return sendAjaxData("NSFormFileEncryptedEnvelop","POST",S,a,JSCallbackEncryptedEnvelop)};e.IWSAFormFileEncryptedEnvelopDefaultDN=function(e,t,a){var r=GetSendFormFilePlantText();var n=InfosecGetCertStoreName("","Encrypt");t=GetSymmetryArithmeticByName(t);var i=["mypluginName=","&PlainText=","&CertStore=","&defultDN=","&SymmetryArithmetic="];var S=[strwebSignDLL,r,n,e,t];var o=JointSendData(i,S);return sendAjaxData("NSFormFileEncryptedEnvelopDefaultDN","POST",o,a,JSCallbackEncryptedEnvelop)};e.IWSAFormFileDecryptEnvelop=function(e,t){clearResponsedList();return DecryptEnvelop("NSFormFileDecryptedEnvelop",e,t,JSCallbackFormFileDecryptedEnvelop)};e.IWSAEncryptedSignEnvelop=function(e,t,a,r,n,i){r=GetDigestArithmeticByName(r);n=GetSymmetryArithmeticByName(n);if(e!=""){e=GetPlanTextForConvertMode(e)}var S=["mypluginName=","&PlainText=","&SignCertIndex=","&EncryptCertIndex=","&DigestArithmetic=","&SymmetryArithmetic="];var o=[strwebSignDLL,e,t,a,r,n];var l=JointSendData(S,o);return sendAjaxData("NSEncryptedSignEnvelop","POST",l,i,JSCallbackEncryptedEnvelop)};e.IWSAEncryptedSignEnvelopDefaultDN=function(e,t,a,r,n,i,S){n=GetDigestArithmeticByName(n);i=GetSymmetryArithmeticByName(i);if(e!=""){e=GetPlanTextForConvertMode(e)}var o=InfosecGetCertStoreName("","Sign");var l=InfosecGetCertStoreName("","Encrypt");var s="";if(r=="1"){s="2"}if(r=="0"){s="0"}var c=["mypluginName=","&PlainText=","&CertStore=","&CertStore1=","&defultDNSign=","&defultDNEncrypt=","&Keyspec=","&DigestArithmetic=","&SymmetryArithmetic="];var u=[strwebSignDLL,e,o,l,t,a,s,n,i];var d=JointSendData(c,u);return sendAjaxData("NSEncryptedSignEnvelopDefaultDN","POST",d,S,JSCallbackEncryptedEnvelop)};e.IWSADecryptSignEnvelop=function(e,t){DecryptSignEnvelop("NSDecryptSignEnvelop",e,t,JSCallbackDecryptSignEnvelop);return};e.IWSAFormFileEncryptedSignEnvelop=function(e,t,a,r,n){var i=GetSendFormFilePlantText();a=GetDigestArithmeticByName(a);r=GetSymmetryArithmeticByName(r);var S=["mypluginName=","&PlainText=","&SignCertIndex=","&EncryptCertIndex=","&DigestArithmetic=","&SymmetryArithmetic="];var o=[strwebSignDLL,i,e,t,a,r];var l=JointSendData(S,o);return sendAjaxData("NSFormFileEncryptedSignEnvelop","POST",l,n,JSCallbackEncryptedEnvelop)};e.IWSAFormFileEncryptedSignEnvelopDefaultDN=function(e,t,a,r,n,i){var S=GetSendFormFilePlantText();r=GetDigestArithmeticByName(r);n=GetSymmetryArithmeticByName(n);var o=InfosecGetCertStoreName("","Sign");var l=InfosecGetCertStoreName("","Encrypt");var s="";if(a=="1"){s="2"}if(a=="0"){s="0"}var c=["mypluginName=","&PlainText=","&CertStore=","&CertStore1=","&defultDNSign=","&defultDNEncrypt=","&Keyspec=","&DigestArithmetic=","&SymmetryArithmetic="];var u=[strwebSignDLL,S,o,l,e,t,s,r,n];var d=JointSendData(c,u);return sendAjaxData("NSFormFileEncryptedSignEnvelopDefaultDN","POST",d,i,JSCallbackEncryptedEnvelop)};e.IWSAFormFileDecryptSignEnvelop=function(e,t){clearResponsedList();DecryptSignEnvelop("NSFormFileDecryptedSignEnvelop",e,t,JSCallbackFormFileDecryptedSignEnvelop);return};e.IWSAGetAllCertsListInfo=function(e,t,a,r){var n=InfosecGetCertStoreName(e,t);var i=["mypluginName=","&CertStore=","&Keyspec="];var S=[strwebSignDLL,n,a];var o=JointSendData(i,S);return sendAjaxData("NSGetCertsListInfo","POST",o,r,JSCallbackGetCertsListInfo)};e.IWSAGetAllCertsListInfoByCertDN=function(e,t,a,r,n){var i=InfosecGetCertStoreName(e,t);var S=["mypluginName=","&CertStore=","&defultDN=","&Keyspec="];var o=[strwebSignDLL,i,a,r];var l=JointSendData(S,o);return sendAjaxData("NSGetCertsListInfo","POST",l,n,JSCallbackGetCertsListInfo)};e.IWSAGetAllCertsListInfoByCertIssuerDNAndCertSN=function(e,t,a,r,n,i){var S=InfosecGetCertStoreName(e,t);var o=["mypluginName=","&CertStore=","&IssuerDN=","&CertSN=","&Keyspec="];var l=[strwebSignDLL,S,a,r,n];var s=JointSendData(o,l);return sendAjaxData("NSGetCertsListInfo","POST",s,i,JSCallbackGetCertsListInfo)};e.IWSASetCertsListInfoCache=function(e,t){var a=["mypluginName=","&IsStore="];var r=[strwebSignDLL,e];var n=JointSendData(a,r);return sendAjaxData("NSSetCertsListInfoCache","POST",n,t,JSCallbackErrorCode)};e.IWSASetDLLCertsListInfoCache=function(e,t,a){var r=["mypluginName=","&IsStore="];var n=[e,t];var i=JointSendData(r,n);return sendAjaxData("NSSetCertsListInfoCache","POST",i,a,JSCallbackErrorCode)};e.IWSAGetCertInfoForIndex=function(e,t){var a=["mypluginName=","&CertIndex="];var r=[strwebSignDLL,e];var n=JointSendData(a,r);return sendAjaxData("NSGetCertInfoForIndex","POST",n,t,JSCallbackGetCertInfoForIndex)};e.IWSAGetCertPublicKeyInfoForIndex=function(e,t){var a=["mypluginName=","&CertIndex="];var r=[strwebSignDLL,e];var n=JointSendData(a,r);return sendAjaxData("NSGetCertPublicKeyInfoForIndex","POST",n,t,JSCallbackGetCertPublicKeyInfoForIndex)};e.IWSAFileEncryptEnvelop=function(e,t,a,r,n,i){n=BASE64URLEN(n);r=GetSymmetryArithmeticByName(r);var S=["mypluginName=","&srcFilePathName=","&decFilePathName=","&FileArithmetic=","&EnvelopArithmetic=","&X509Cert="];var o=[strwebSignDLL,e,t,a,r,n];var l=JointSendData(S,o);return sendAjaxData("NSFileEncryptEnvelop","POST",l,i,JSCallbackEncryptedEnvelop)};e.IWSAFileDecryptEnvelop=function(e,t,a,r){a=BASE64URLEN(a);var n=["mypluginName=","&srcFilePathName=","&decFilePathName=","&EnvelopMsg="];var i=[strwebSignDLL,e,t,a];var S=JointSendData(n,i);return sendAjaxData("NSFileDecryptEnvelop","POST",S,r,JSCallbackErrorCode)};e.IWSASkfGetCertList=function(e,t){var a=["mypluginName=","&DllFilePath="];var r=[strwebSignSKFDLL,e];var n=JointSendData(a,r);return sendAjaxData("NSSkfGetCertsListInfo","POST",n,t,JSCallbackSkfGetCertsListInfo)};e.IWSASkfSignData=function(e,t,a,r,n){r=GetDigestArithmeticByName(r);if(e!=""){e=GetPlanTextForConvertMode(e)}var i=["mypluginName=","&PlainText=","&CertIndex=","&UsbKeyPin=","&DigestArithmetic="];var S=[strwebSignSKFDLL,e,t,a,r];var o=JointSendData(i,S);return sendAjaxData("NSSkfAttachedSign","POST",o,n,JSCallbackNSSigned)};e.IWSASkfAttachedSignWithDN=function(e,t,a,r,n,i,S){r=GetDigestArithmeticByName(r);if(e!=""){e=GetPlanTextForConvertMode(e)}var o="";if(i=="1"){o="2"}if(i=="0"){o="0"}var l=["mypluginName=","&PlainText=","&defultDN=","&UsbKeyPin=","&DigestArithmetic=","&DllFilename=","&Keyspec="];var s=[strwebSignSKFDLL,e,t,a,r,n,o];var c=JointSendData(l,s);return sendAjaxData("NSSkfAttachedSign","POST",c,S,JSCallbackNSSigned)};e.IWSASkfVerifySignData=function(e,t,a,r,n,i){if(t!=""){t=GetPlanTextForConvertMode(t)}var S=["mypluginName=","&signedMsg=","&PlainText=","&CertIndex=","&UsbKeyPin=","&DllFilename="];var o=[strwebSignSKFDLL,e,t,a,r,n];var l=JointSendData(S,o);return sendAjaxData("NSSkfAttachedVerify","POST",l,i,JSCallbackSkfAttachedVerify)};e.IWSASkfDetachedSign=function(e,t,a,r,n){r=GetDigestArithmeticByName(r);if(e!=""){e=GetPlanTextForConvertMode(e)}var i=["mypluginName=","&PlainText=","&CertIndex=","&UsbKeyPin=","&DigestArithmetic="];var S=[strwebSignSKFDLL,e,t,a,r];var o=JointSendData(i,S);return sendAjaxData("NSSkfDetachedSign","POST",o,n,JSCallbackNSSigned)};e.IWSASkfDetachedSignDefaultDN=function(e,t,a,r,n,i,S){r=GetDigestArithmeticByName(r);if(e!=""){e=GetPlanTextForConvertMode(e)}var o="";if(i=="1"){o="2"}if(i=="0"){o="0"}var l=["mypluginName=","&PlainText=","&DefaultDN=","&UsbKeyPin=","&DigestArithmetic=","&DllFilePath=","&Keyspec="];var s=[strwebSignSKFDLL,e,t,a,r,n,o];var c=JointSendData(l,s);return sendAjaxData("NSSkfDetachedSign","POST",c,S,JSCallbackNSSigned)};e.IWSASkfDetachedVerify=function(e,t,a){if(t!=""){t=GetPlanTextForConvertMode(t)}var r=["mypluginName=","&SignedMsg=","&PlainText="];var n=[strwebSignSKFDLL,e,t];var i=JointSendData(r,n);return sendAjaxData("NSSkfDetachedVerify","POST",i,a,JSCallbackSkfDetachedVerify)};e.IWSASkfRawSign=function(e,t,a,r,n){r=GetDigestArithmeticByName(r);if(e!=""){e=GetPlanTextForConvertMode(e)}var i=["mypluginName=","&PlainText=","&CertIndex=","&UsbKeyPin=","&DigestArithmetic="];var S=[strwebSignSKFDLL,e,t,a,r];var o=JointSendData(i,S);return sendAjaxData("NSSkfRawSign","POST",o,n,JSCallbackNSSigned)};e.IWSASkfRawSignDefaultDN=function(e,t,a,r,n,i,S){n=GetDigestArithmeticByName(n);if(e!=""){e=GetPlanTextForConvertMode(e)}var o="";if(a=="1"){o="2"}if(a=="0"){o="0"}var l=["mypluginName=","&PlainText=","&DefaultDN=","&Keyspec=","&UsbKeyPin=","&DigestArithmetic=","&DllFilePath="];var s=[strwebSignSKFDLL,e,t,o,r,n,i];var c=JointSendData(l,s);return sendAjaxData("NSSkfRawSign","POST",c,S,JSCallbackNSSigned)};e.IWSASkfRawVerify=function(e,t,a,r,n,i){r=GetDigestArithmeticByName(r);if(e!=""){e=GetPlanTextForConvertMode(e)}t=BASE64URLEN(t);var S=["mypluginName=","&PlainText=","&SignedMsg=","&CertIndex=","&DigestArithmetic=","&DllFilePath="];var o=[strwebSignSKFDLL,e,t,a,r,n];var l=JointSendData(S,o);return sendAjaxData("NSSkfRawVerify","POST",l,i,JSCallbackSkfDetachedVerify)};e.IWSASkfRawVerifyDefaultDN=function(e,t,a,r,n,i,S){n=GetDigestArithmeticByName(n);if(e!=""){e=GetPlanTextForConvertMode(e)}t=BASE64URLEN(t);var o="";if(r=="1"){o="2"}if(r=="0"){o="0"}var l=["mypluginName=","&PlainText=","&SignedMsg=","&DefaultDN=","&DigestArithmetic=","&DllFilePath=","&Keyspec="];var s=[strwebSignSKFDLL,e,t,a,n,i,o];var c=JointSendData(l,s);return sendAjaxData("NSSkfRawVerify","POST",c,S,JSCallbackSkfDetachedVerify)};e.IWSASetSKFEnvelopeP7symmDer=function(e,t){var a=["mypluginName=","&P7symmDer="];var r=[strwebSignSKFDLL,e];var n=JointSendData(a,r);return sendAjaxData("NSSKFEnvelopeP7symmDer","POST",n,t,JSCallbackErrorCode)};e.IWSASkfEncryptedEnvelop=function(e,t,a,r){if(e!=""){e=GetPlanTextForConvertMode(e)}var n=["mypluginName=","&PlainText=","&EncCert=","&SymmetryArithmetic="];var i=[strwebSignSKFDLL,e,t,a];var S=JointSendData(n,i);return sendAjaxData("NSSkfEncryptedEnvelop","POST",S,r,JSCallbackSkfEncryptedSignEnvelop)};e.IWSASkfEncryptedSignEnvelop=function(e,t,a,r,n,i,S){n=GetDigestArithmeticByName(n);if(e!=""){e=GetPlanTextForConvertMode(e)}var o=["mypluginName=","&PlainText=","&EncCert=","&CertIndex=","&UsbKeyPin=","&DigestArithmetic=","&SymmetryArithmetic="];var l=[strwebSignSKFDLL,e,t,a,r,n,i];var s=JointSendData(o,l);return sendAjaxData("NSSkfEncryptedSignEnvelop","POST",s,S,JSCallbackSkfEncryptedSignEnvelop)};e.IWSASkfEncryptedSignEnvelopDefaultDN=function(e,t,a,r,n,i,S,o,l){i=GetDigestArithmeticByName(i);if(e!=""){e=GetPlanTextForConvertMode(e)}var s="";if(r=="1"){s="2"}if(r=="0"){s="0"}var c=["mypluginName=","&PlainText=","&EncCert=","&DefaultDN=","&Keyspec=","&UsbKeyPin=","&DigestArithmetic=","&SymmetryArithmetic=","&DllFilePath="];var u=[strwebSignSKFDLL,e,t,a,s,n,i,S,o];var d=JointSendData(c,u);return sendAjaxData("NSSkfEncryptedSignEnvelop","POST",d,l,JSCallbackSkfEncryptedSignEnvelop)};e.IWSASetCertEnrollConnectType=function(e,t){var a=["mypluginName=","&nType="];var r=[strwebEnrollSM2SKFDLL,e];var n=JointSendData(a,r);return sendAjaxData("NSSetCertEnrollConnectType","POST",n,t,JSCallbackErrorCode)};e.IWSASetCertEnrollShowErrMsg=function(e,t){var a=["mypluginName=","&IsShow="];var r=[strwebEnrollToolDLL,e];var n=JointSendData(a,r);return sendAjaxData("NSSetCertEnrollShowErrMsg","POST",n,t,JSCallbackErrorCode)};e.IWSASetCertEnrollDLLShowErrMsg=function(e,t,a){var r=["mypluginName=","&IsShow="];var n=[e,t];var i=JointSendData(r,n);return sendAjaxData("NSSetCertEnrollShowErrMsg","POST",i,a,JSCallbackErrorCode)};e.IWSAGetEVersion=function(e){var t="mypluginName="+strwebEnrollToolDLL;return sendAjaxData("NSGetEVersion","GET",t,e,JSCallbackGetVersion)};e.IWSAGetERsaCertStore=function(e){var t="mypluginName="+strwebEnrollToolDLL;return sendAjaxData("NSGetRsaCertStore","GET",t,e,JSCallbackGetRsaCertStore)};e.IWSAGetESm2CFCACertStore=function(e){var t="mypluginName="+strwebEnrollToolDLL;return sendAjaxData("NSGetSm2CFCACertStore","GET",t,e,JSCallbackGetRsaCertStore)};e.IWSAGetDistinctNameKeyValuePairNumber=function(e,t){var a=["mypluginName=","&DN="];var r=[strwebEnrollToolDLL,e];var n=JointSendData(a,r);return sendAjaxData("NSGetDistinctNameKeyValuePairNumber","POST",n,t,JSCallbackGetDistinctNameKeyValuePairNumber)};e.IWSAGetDistinctNameKeyValuePair=function(e,t,a){var r=["mypluginName=","&DN=","&Index="];var n=[strwebEnrollToolDLL,e,t];var i=JointSendData(r,n);return sendAjaxData("NSGetDistinctNameKeyValuePair","POST",i,a,JSCallbackGetDistinctNameKeyValuePair)};e.IWSAECompareCertTime=function(e,t,a){var r=["mypluginName=","&CT1=","&CT2="];var n=[strwebEnrollToolDLL,e,t];var i=JointSendData(r,n);return sendAjaxData("NSCompareCertTime","POST",i,a,JSCallbackCompareCertTime)};e.IWSAGenSecureAuthCode=function(e,t,a,r){var n=["mypluginName=","&RefNo=","&AuthCode=","&P10="];var i=[strwebEnrollToolDLL,e,t,a];var S=JointSendData(n,i);return sendAjaxData("NSGenSecureAuthCode","POST",S,r,JSCallbackGetDataParem)};e.IWSAGetX509CertInfo=function(e,t){var a=["mypluginName=","&X509Cert="];var r=[strwebEnrollToolDLL,e];var n=JointSendData(a,r);return sendAjaxData("NSGetX509CertInfo","POST",n,t,JSCallbackGetX509CertInfo)};e.IWSAGetX509FromP7Cert=function(e,t){var a=["mypluginName=","&P7Cert="];var r=[strwebEnrollToolDLL,e];var n=JointSendData(a,r);return sendAjaxData("NSGetX509FromP7Cert","POST",n,t,JSCallbackGetDataParem)};e.IWSA_rsa_csp_listProvider=function(e){var t="mypluginName="+strwebEnrollRSADLL;return sendAjaxData("NSGetRsaCspListProvider","GET",t,e,JSCallbackGetRsaCspListProvider)};e.IWSA_rsa_csp_getCountOfCert=function(e){var t="mypluginName="+strwebEnrollRSADLL;return sendAjaxData("NSGetRsaCspCountOfCert","GET",t,e,JSCallbackGetCountOfCert)};e.IWSA_rsa_csp_getCertInfo=function(e,t){var a=["mypluginName=","&CertIndex="];var r=[strwebEnrollRSADLL,e];var n=JointSendData(a,r);return sendAjaxData("NSGetRsaCspCertInfo","POST",n,t,JSCallbackGetRsaCspCertInfo)};e.IWSA_rsa_csp_AdvgenContainerP10=function(e,t,a,r){var n=["mypluginName=","&CspName=","&IKeySize=","&DN=","&bDoubleCert="];var i=[strwebEnrollRSADLL,m_CspName,e,t,a];var S=JointSendData(n,i);return sendAjaxData("NSAdvRsaCspGenContainerP10","POST",S,r,JSCallbackAdvRsaCspGenContainerP10)};e.IWSA_rsa_csp_AdvImportSignEncCert=function(e,t,a,r,n,i){if(e=="X509"){var S=["mypluginName=","&CspName=","&SignCert_Base64=","&EncCert_Base64=","&EncPrikey_Base64=","&UKEK_Base64="];var o=[strwebEnrollRSADLL,m_CspName,t,a,r,n];var l=JointSendData(S,o);return sendAjaxData("NSRsaCspImportSignEncX509Cert","POST",l,i,JSCallbackErrorCode)}if(e=="P7"){var S=["mypluginName=","&CspName=","&SignCert_Base64=","&EncCert_Base64=","&EncPrikey_Base64=","&UKEK_Base64="];var o=[strwebEnrollRSADLL,m_CspName,t,a,r,n];var l=JointSendData(S,o);return sendAjaxData("NSRsaCspImportSignEncP7Cert","POST",l,i,JSCallbackErrorCode)}};e.IWSA_rsa_csp_setProvider=function(e){m_CspName=e;return};e.IWSA_rsa_csp_deleteContainer=function(e,t){var a=["mypluginName=","&CspName=","&Container="];var r=[strwebEnrollRSADLL,m_CspName,e];var n=JointSendData(a,r);return sendAjaxData("NSRsaCspDeleteContainer","POST",n,t,JSCallbackErrorCode)};e.IWSA_rsa_csp_createContainer=function(e,t){var a=["mypluginName=","&CspName=","&Container="];var r=[strwebEnrollRSADLL,m_CspName,e];var n=JointSendData(a,r);return sendAjaxData("NSRsaCspCreateContainer","POST",n,t,JSCallbackErrorCode)};e.IWSA_rsa_csp_delContainer=function(e,t,a){var r=["mypluginName=","&CspNamedel=","&Container="];var n=[strwebEnrollRSADLL,e,t];var i=JointSendData(r,n);return sendAjaxData("NSRsaCspDelContainer","POST",i,a,JSCallbackErrorCode)};e.IWSA_rsa_csp_genContainer=function(e){var t=["mypluginName=","&CspName="];var a=[strwebEnrollRSADLL,m_CspName];var r=JointSendData(t,a);return sendAjaxData("NSRsaCspGenContainer","POST",r,e,JSCallbackRsaCspGenContainer)};e.IWSA_rsa_csp_genContainerP10=function(e,t,a,r,n,i,S,o,l){var s=["mypluginName=","&CspName=","&bSign=","&KeySize=","&DN=","&DigestOID=","&PubKeyAlgOID=","&SignAlgOID=","&bExport=","&bProtect="];var c=[strwebEnrollRSADLL,m_CspName,e,t,a,r,n,i,S,o];var u=JointSendData(s,c);return sendAjaxData("NSRsaCspGenContainerP10","POST",u,l,JSCallbackRsaCspGenContainerP10)};e.IWSA_rsa_csp_genP10=function(e,t,a,r,n,i,S,o,l,s){var c=["mypluginName=","&CspName=","&Container=","&bSign=","&KeySize=","&DN=","&DigestOID=","&PubKeyAlgOID=","&SignAlgOID=","&bExport=","&bProtect="];var u=[strwebEnrollRSADLL,m_CspName,e,t,a,r,n,i,S,o,l];var d=JointSendData(c,u);return sendAjaxData("NSRsaCspGenP10","POST",d,s,JSCallbackGetDataParem)};e.IWSA_rsa_csp_genEncKeyPair=function(e){var t=["mypluginName=","&CspName="];var a=[strwebEnrollRSADLL,m_CspName];var r=JointSendData(t,a);return sendAjaxData("NSRsaCspGenEncKeyPair","POST",r,e,JSCallbackGetDataParem)};e.IWSA_rsa_csp_delEncKeyPair=function(e){var t=["mypluginName=","&CspName="];var a=[strwebEnrollRSADLL,m_CspName];var r=JointSendData(t,a);return sendAjaxData("NSRsaCspDelEncKeyPair","POST",r,e,JSCallbackErrorCode)};e.IWSA_rsa_csp_importX509CertToStore=function(e,t,a){var r=["mypluginName=","&CspName=","&X509Cert=","&bRoot="];var n=[strwebEnrollRSADLL,m_CspName,e,t];var i=JointSendData(r,n);return sendAjaxData("NSRsaCspImportX509CertToStore","POST",i,a,JSCallbackErrorCode)};e.IWSA_rsa_csp_delX509CertInStore=function(e,t,a){var r=["mypluginName=","&CspName=","&Issuer=","&Serial="];var n=[strwebEnrollRSADLL,m_CspName,e,t];var i=JointSendData(r,n);return sendAjaxData("NSRsaCspDelX509CertInStore","POST",i,a,JSCallbackErrorCode)};e.IWSA_rsa_csp_importSignX509Cert=function(e,t,a){var r=["mypluginName=","&CspName=","&Container=","&X509Cert="];var n=[strwebEnrollRSADLL,m_CspName,e,t];var i=JointSendData(r,n);return sendAjaxData("NSRsaCspImportSignX509Cert","POST",i,a,JSCallbackErrorCode)};e.IWSA_rsa_csp_importEncX509Cert=function(e,t,a,r,n,i,S){var o=["mypluginName=","&CspName=","&Container=","&X509Cert=","&EncPrikey=","&UKEK=","&bExport=","&bProtect="];var l=[strwebEnrollRSADLL,m_CspName,e,t,a,r,n,i];var s=JointSendData(o,l);return sendAjaxData("NSRsaCspImportEncX509Cert","POST",s,S,JSCallbackErrorCode)};e.IWSA_rsa_csp_importSignP7Cert=function(e,t,a){var r=["mypluginName=","&CspName=","&Container=","&P7Cert="];var n=[strwebEnrollRSADLL,m_CspName,e,t];var i=JointSendData(r,n);return sendAjaxData("NSRsaCspImportSignP7Cert","POST",i,a,JSCallbackErrorCode)};e.IWSA_rsa_csp_importEncP7Cert=function(e,t,a,r,n,i,S){var o=["mypluginName=","&CspName=","&Container=","&P7Cert=","&EncPrikey=","&UKEK=","&bExport=","&bProtect="];var l=[strwebEnrollRSADLL,m_CspName,e,t,a,r,n,i];var s=JointSendData(o,l);return sendAjaxData("NSRsaCspImportEncP7Cert","POST",s,S,JSCallbackErrorCode)};e.IWSA_rsa_csp_exportSignX509Cert=function(e,t){var a=["mypluginName=","&CspName=","&Container="];var r=[strwebEnrollRSADLL,m_CspName,e];var n=JointSendData(a,r);return sendAjaxData("NSRsaCspExportSignX509Cert","POST",n,t,JSCallbackGetDataParem)};e.IWSA_rsa_csp_exportEncX509Cert=function(e,t){var a=["mypluginName=","&CspName=","&Container="];var r=[strwebEnrollRSADLL,m_CspName,e];var n=JointSendData(a,r);return sendAjaxData("NSRsaCspExportEncX509Cert","POST",n,t,JSCallbackGetDataParem)};e.IWSA_rsa_csp_exportPfxCert=function(e,t,a,r,n){var i=["mypluginName=","&CspName=","&Issuer=","&Serial=","&Password=","&bSaveAs="];var S=[strwebEnrollRSADLL,m_CspName,e,t,a,r];var o=JointSendData(i,S);return sendAjaxData("NSRsaCspExportPfxCert","POST",o,n,JSCallbackGetDataParem)};e.IWSA_rsa_csp_exportContainerPfxCert=function(e,t,a,r,n){var i=["mypluginName=","&CspName=","&Container=","&bSignCert=","&Password=","&bSaveAs="];var S=[strwebEnrollRSADLL,m_CspName,e,t,a,r];var o=JointSendData(i,S);return sendAjaxData("NSRsaCspExportContainerPfxCert","POST",o,n,JSCallbackGetDataParem)};e.IWSA_rsa_csp_signData=function(e,t,a,r){var n=["mypluginName=","&CspName=","&Container=","&PlantText=","&DigestOID="];var i=[strwebEnrollRSADLL,m_CspName,e,t,a];var S=JointSendData(n,i);return sendAjaxData("NSRsaCspSignData","POST",S,r,JSCallbackGetDataParem)};e.IWSA_rsa_csp_verifySignData=function(e,t,a,r,n){var i=["mypluginName=","&CspName=","&Container=","&PlantText=","&DigestOID=","&SignedData="];var S=[strwebEnrollRSADLL,m_CspName,e,t,a,r];var o=JointSendData(i,S);return sendAjaxData("NSRsaCspVerifySignData","POST",o,n,JSCallbackErrorCode)};e.IWSA_rsa_csp_encryptData=function(e,t,a){var r=["mypluginName=","&CspName=","&Container=","&PlantText="];var n=[strwebEnrollRSADLL,m_CspName,e,t];var i=JointSendData(r,n);return sendAjaxData("NSRsaCspEncryptData","POST",i,a,JSCallbackGetDataParem)};e.IWSA_rsa_csp_decryptData=function(e,t,a){var r=["mypluginName=","&CspName=","&Container=","&EncryptText="];var n=[strwebEnrollRSADLL,m_CspName,e,t];var i=JointSendData(r,n);return sendAjaxData("NSRsaCspDecryptData","POST",i,a,JSCallbackGetDataParem)};e.IWSA_sm2_cfca_listProvider=function(e){var t="mypluginName="+strwebEnrollSM2CFCADLL;return sendAjaxData("NSSm2CfcaGetProviderList","GET",t,e,JSCallbackGetRsaCspListProvider)};e.IWSA_sm2_cfca_getCountOfCert=function(e){var t="mypluginName="+strwebEnrollSM2CFCADLL;return sendAjaxData("NSSm2CfcaGetCountOfCert","GET",t,e,JSCallbackGetCountOfCert)};e.IWSA_sm2_cfca_getCertInfo=function(e,t){var a=["mypluginName=","&CertIndex="];var r=[strwebEnrollSM2CFCADLL,e];var n=JointSendData(a,r);return sendAjaxData("NSSm2CfcaGetCertInfo","POST",n,t,JSCallbackGetRsaCspCertInfo)};e.IWSA_sm2_cfca_setProvider=function(e){m_CspName=e;return};e.IWSA_sm2_cfca_deleteContainer=function(e,t){var a=["mypluginName=","&CspName=","&Container="];var r=[strwebEnrollSM2CFCADLL,m_CspName,e];var n=JointSendData(a,r);return sendAjaxData("NSSm2CfcaDeleteContainer","POST",n,t,JSCallbackErrorCode)};e.IWSA_sm2_cfca_createContainer=function(e,t){var a=["mypluginName=","&CspName=","&Container="];var r=[strwebEnrollSM2CFCADLL,m_CspName,e];var n=JointSendData(a,r);return sendAjaxData("NSSm2CfcaCreateContainer","POST",n,t,JSCallbackErrorCode)};e.IWSA_sm2_cfca_delContainer=function(e,t,a){var r=["mypluginName=","&CspNamedel=","&Container="];var n=[strwebEnrollSM2CFCADLL,e,t];var i=JointSendData(r,n);return sendAjaxData("NSSm2CfcaDelContainer","POST",i,a,JSCallbackErrorCode)};e.IWSA_sm2_cfca_genContainer=function(e){var t=["mypluginName=","&CspName="];var a=[strwebEnrollSM2CFCADLL,m_CspName];var r=JointSendData(t,a);return sendAjaxData("NSSm2CfcaGenContainer","POST",r,e,JSCallbackRsaCspGenContainer)};e.IWSA_sm2_cfca_genContainerP10Encpubkey=function(e,t){var a=["mypluginName=","&CspName=","&DN="];var r=[strwebEnrollSM2CFCADLL,m_CspName,e];var n=JointSendData(a,r);return sendAjaxData("NSSm2CfcaGenContainerP10Encpubkey","POST",n,t,JSCallbackSm2CfcaGenContainerP10Encpubkey)};e.IWSA_sm2_cfca_genP10Encpubkey=function(e,t,a){var r=["mypluginName=","&CspName=","&Container=","&DN="];var n=[strwebEnrollSM2CFCADLL,m_CspName,e,t];var i=JointSendData(r,n);return sendAjaxData("NSSm2CfcaGenP10Encpubkey","POST",i,a,JSCallbackSm2CfcaGenP10Encpubkey)};e.IWSA_sm2_cfca_importSignX509Cert=function(e,t,a){var r=["mypluginName=","&CspName=","&Container=","&X509Cert="];var n=[strwebEnrollSM2CFCADLL,m_CspName,e,t];var i=JointSendData(r,n);return sendAjaxData("NSSm2CfcaImportSignX509Cert","POST",i,a,JSCallbackErrorCode)};e.IWSA_sm2_cfca_importEncX509Cert=function(e,t,a,r){var n=["mypluginName=","&CspName=","&Container=","&X509Cert=","&EncPrikey="];var i=[strwebEnrollSM2CFCADLL,m_CspName,e,t,a];var S=JointSendData(n,i);return sendAjaxData("NSSm2CfcaImportEncX509Cert","POST",S,r,JSCallbackErrorCode)};e.IWSA_sm2_cfca_AdvImportSignEncX509Cert=function(e,t,a,r){var n=["mypluginName=","&CspName=","&SignCert=","&EncCert=","&EncPrikey="];var i=[strwebEnrollSM2CFCADLL,m_CspName,e,t,a];var S=JointSendData(n,i);return sendAjaxData("NSSm2CfcaImportSignEncX509Cert","POST",S,r,JSCallbackErrorCode)};e.IWSA_sm2_cfca_signData=function(e,t,a){var r=["mypluginName=","&CspName=","&Container=","&PlantText="];var n=[strwebEnrollSM2CFCADLL,m_CspName,e,t];var i=JointSendData(r,n);return sendAjaxData("NSSm2CfcaSignData","POST",i,a,JSCallbackGetDataParem)};e.IWSA_sm2_skf_getCountOfCert=function(e){var t="mypluginName="+strwebEnrollSM2SKFDLL;return sendAjaxData("NSSm2SkfGetCountOfCert","GET",t,e,JSCallbackGetCountOfCert)};e.IWSA_sm2_skf_getCertInfo=function(e,t){var a=["mypluginName=","&CertIndex="];var r=[strwebEnrollSM2SKFDLL,e];var n=JointSendData(a,r);return sendAjaxData("NSSm2SkfGetCertInfo","POST",n,t,JSCallbackSm2SkfGetCertInfo)};e.IWSA_sm2_skf_getProviderList=function(e){var t="mypluginName="+strwebEnrollSM2SKFDLL;return sendAjaxData("NSSm2SkfGetProviderList","GET",t,e,JSCallbackSm2SkfGetProviderList)};e.IWSA_sm2_skf_getDeviceList=function(e,t){var a=["mypluginName=","&Provider="];var r=[strwebEnrollSM2SKFDLL,e];var n=JointSendData(a,r);return sendAjaxData("NSSm2SkfGetDeviceList","POST",n,t,JSCallbackSm2SkfGetDeviceList)};e.IWSA_sm2_skf_getApplicationList=function(e,t,a){var r=["mypluginName=","&Provider=","&Device="];var n=[strwebEnrollSM2SKFDLL,e,t];var i=JointSendData(r,n);return sendAjaxData("NSSm2SkfGetApplicationList","POST",i,a,JSCallbackSm2SkfGetApplicationList)};e.IWSA_sm2_skf_useDevice=function(e,t,a){SkfDeviceType=1;SkfUseDeviceInfoAry[0]=e;SkfUseDeviceInfoAry[1]=t;SkfUseDeviceInfoAry[2]="";if(a=="true"||a=="false"){SkfUseDeviceInfoAry[2]=a}return};e.IWSA_sm2_skf_useDevice_Long=function(e,t,a,r){SkfDeviceType=1;SkfUseDeviceInfoAry[0]=e;SkfUseDeviceInfoAry[1]=t;SkfUseDeviceInfoAry[2]="";if(a=="true"||a=="false"){SkfUseDeviceInfoAry[2]=a}var n=GetSkfTitleParameterAndAllreadyDevice();var i=GetSkfDataParameterAndAllreadyDevice();var S=JointSendData(n,i);return sendAjaxData("NSSm2SkfUseDevice","POST",S,r,JSCallbackErrorCode)};e.IWSA_sm2_skf_setDevice=function(e,t,a){SkfDeviceType=2;SkfSetDeviceInfoAry[0]=e;SkfSetDeviceInfoAry[1]=t;SkfSetDeviceInfoAry[2]=a;return};e.IWSA_sm2_skf_setDevice_Long=function(e,t,a,r){SkfDeviceType=2;SkfSetDeviceInfoAry[0]=e;SkfSetDeviceInfoAry[1]=t;SkfSetDeviceInfoAry[2]=a;var n=GetSkfTitleParameterAndAllreadyDevice();var i=GetSkfDataParameterAndAllreadyDevice();var S=JointSendData(n,i);return sendAjaxData("NSSm2SkfSetDevice","POST",S,r,JSCallbackErrorCode)};e.IWSA_sm2_skf_getContainerList=function(e){var t=GetSkfTitleParameterAndAllreadyDevice();var a=GetSkfDataParameterAndAllreadyDevice();var r=JointSendData(t,a);return sendAjaxData("NSSm2SkfGetContainerList","POST",r,e,JSCallbackSm2SkfGetContainerList)};e.IWSA_sm2_skf_getDeviceInfo=function(e,t,a){var r=["mypluginName=","&Provider=","&Device="];var n=[strwebEnrollSM2SKFDLL,e,t];var i=JointSendData(r,n);return sendAjaxData("NSSm2SkfGetDeviceInfo","POST",i,a,JSCallbackSm2SkfGetDeviceInfo)};e.IWSA_sm2_skf_verifyPin=function(e,t){var a=GetSkfTitleParameterAndAllreadyDevice("PIN");var r=GetSkfDataParameterAndAllreadyDevice(e);var n=JointSendData(a,r);return sendAjaxData("NSSm2SkfVerifyPin","POST",n,t,JSCallbackErrorCode)};e.IWSA_sm2_skf_verifyPinOfCtrl=function(e){var t=GetSkfTitleParameterAndAllreadyDevice();var a=GetSkfDataParameterAndAllreadyDevice();var r=JointSendData(t,a);return sendAjaxData("NSSm2SkfVerifyPinOfCtrl","POST",r,e,JSCallbackErrorCode)};e.IWSA_sm2_skf_getPinInfo=function(e){var t=GetSkfTitleParameterAndAllreadyDevice();var a=GetSkfDataParameterAndAllreadyDevice();var r=JointSendData(t,a);return sendAjaxData("NSSm2SkfGetPinInfo","POST",r,e,JSCallbackSm2SkfGetPinInfo)};e.IWSA_sm2_skf_createContainer=function(e,t,a){var r=GetSkfTitleParameterAndAllreadyDevice("PIN","Container");var n=GetSkfDataParameterAndAllreadyDevice(e,t);var i=JointSendData(r,n);return sendAjaxData("NSSm2SkfCreateContainer","POST",i,a,JSCallbackErrorCode)};e.IWSA_sm2_skf_delContainer=function(e,t,a,r,n,i){var S=GetSkfTitleParameterAndAllreadyDevice("Providerdel","Devicedel","Applicationdel","Containerdel","bVerifyPin");var o=GetSkfDataParameterAndAllreadyDevice(e,t,a,r,n);var l=JointSendData(S,o);return sendAjaxData("NSSm2SkfDelContainer","POST",l,i,JSCallbackErrorCode)};e.IWSA_sm2_skf_deleteContainer=function(e,t,a){var r=GetSkfTitleParameterAndAllreadyDevice("PIN","Container");var n=GetSkfDataParameterAndAllreadyDevice(e,t);var i=JointSendData(r,n);return sendAjaxData("NSSm2SkfDeleteContainer","POST",i,a,JSCallbackErrorCode)};e.IWSA_sm2_skf_writeData=function(e,t,a){var r=GetSkfTitleParameterAndAllreadyDevice("PIN","Data");var n=GetSkfDataParameterAndAllreadyDevice(e,t);var i=JointSendData(r,n);return sendAjaxData("NSSm2SkfWriteData","POST",i,a,JSCallbackErrorCode)};e.IWSA_sm2_skf_readData=function(e,t){var a=GetSkfTitleParameterAndAllreadyDevice("PIN");var r=GetSkfDataParameterAndAllreadyDevice(e);var n=JointSendData(a,r);return sendAjaxData("NSSm2SkfReadData","POST",n,t,JSCallbackSm2SkfReadData)};e.IWSA_sm2_skf_genContainer=function(e,t){var a=GetSkfTitleParameterAndAllreadyDevice("PIN");var r=GetSkfDataParameterAndAllreadyDevice(e);var n=JointSendData(a,r);return sendAjaxData("NSSm2SkfGenContainer","POST",n,t,JSCallbackRsaCspGenContainer)};e.IWSA_sm2_skf_genContainerP10=function(e,t,a,r,n){var i=GetSkfTitleParameterAndAllreadyDevice("PIN","DN","ID","bID");var S=GetSkfDataParameterAndAllreadyDevice(e,t,a,r);var o=JointSendData(i,S);return sendAjaxData("NSSm2SkfGenContainerP10","POST",o,n,JSCallbackRsaCspGenContainerP10)};e.IWSA_sm2_skf_genP10=function(e,t,a,r,n,i){var S=GetSkfTitleParameterAndAllreadyDevice("PIN","Container","DN","ID","bID");var o=GetSkfDataParameterAndAllreadyDevice(e,t,a,r,n);var l=JointSendData(S,o);return sendAjaxData("NSSm2SkfGenP10","POST",l,i,JSCallbackGetDataParem)};e.IWSA_sm2_skf_getEnveloped=function(e,t,a,r,n){var i=["mypluginName=","&X509Cert=","&SGDSMECB=","&EncPrikey=","&UKEK="];var S=[strwebEnrollSM2SKFDLL,e,t,a,r];var o=JointSendData(i,S);return sendAjaxData("NSSm2SkfGetEnveloped","POST",o,n,JSCallbackGetDataParem)};e.IWSA_sm2_skf_importSignX509Cert=function(e,t,a,r){var n=GetSkfTitleParameterAndAllreadyDevice("PIN","Container","X509Cert");var i=GetSkfDataParameterAndAllreadyDevice(e,t,a);var S=JointSendData(n,i);return sendAjaxData("NSSm2SkfImportSignX509Cert","POST",S,r,JSCallbackErrorCode)};e.IWSA_sm2_skf_importEncX509Cert=function(e,t,a,r,n){var i=GetSkfTitleParameterAndAllreadyDevice("PIN","Container","X509Cert","EncPrikey");var S=GetSkfDataParameterAndAllreadyDevice(e,t,a,r);var o=JointSendData(i,S);return sendAjaxData("NSSm2SkfImportEncX509Cert","POST",o,n,JSCallbackErrorCode)};e.IWSA_sm2_skf_AdvImportSignEncX509Cert=function(e,t,a,r,n){var i=GetSkfTitleParameterAndAllreadyDevice("PIN","SignCert","EncCert","EncPrikey");var S=GetSkfDataParameterAndAllreadyDevice(e,t,a,r);var o=JointSendData(i,S);return sendAjaxData("NSSm2SkfImportSignEncX509Cert","POST",o,n,JSCallbackErrorCode)};e.IWSA_sm2_skf_exportSignX509Cert=function(e,t,a){var r=GetSkfTitleParameterAndAllreadyDevice("PIN","Container");var n=GetSkfDataParameterAndAllreadyDevice(e,t);var i=JointSendData(r,n);return sendAjaxData("NSSm2SkfExportSignX509Cert","POST",i,a,JSCallbackGetDataParem)};e.IWSA_sm2_skf_exportEncX509Cert=function(e,t,a){var r=GetSkfTitleParameterAndAllreadyDevice("PIN","Container");var n=GetSkfDataParameterAndAllreadyDevice(e,t);var i=JointSendData(r,n);return sendAjaxData("NSSm2SkfExportEncX509Cert","POST",i,a,JSCallbackGetDataParem)};e.IWSA_sm2_skf_signData=function(e,t,a,r,n,i){var S=GetSkfTitleParameterAndAllreadyDevice("PIN","Container","PlantText","ID","bID");var o=GetSkfDataParameterAndAllreadyDevice(e,t,a,r,n);var l=JointSendData(S,o);return sendAjaxData("NSSm2SkfSignData","POST",l,i,JSCallbackGetDataParem)};e.IWSA_sm2_skf_verifySignData=function(e,t,a,r,n,i,S){var o=GetSkfTitleParameterAndAllreadyDevice("PIN","Container","PlantText","SignData","ID","bID");var l=GetSkfDataParameterAndAllreadyDevice(e,t,a,r,n,i);var s=JointSendData(o,l);return sendAjaxData("NSSm2SkfVerifySignData","POST",s,S,JSCallbackErrorCode)};e.IWSA_sm2_skf_encryptData=function(e,t,a,r){var n=GetSkfTitleParameterAndAllreadyDevice("PIN","Container","PlantText");var i=GetSkfDataParameterAndAllreadyDevice(e,t,a);var S=JointSendData(n,i);return sendAjaxData("NSSm2SkfEncryptData","POST",S,r,JSCallbackGetDataParem)};e.IWSA_sm2_skf_decryptData=function(e,t,a,r){var n=GetSkfTitleParameterAndAllreadyDevice("PIN","Container","EncryptText");var i=GetSkfDataParameterAndAllreadyDevice(e,t,a);var S=JointSendData(n,i);return sendAjaxData("NSSm2SkfDecryptData","POST",S,r,JSCallbackGetDataParem)};e.IWSA_sm2_skf_GenContainerECCKeyPair=function(e,t,a){var r=GetSkfTitleParameterAndAllreadyDevice("PIN","Container");var n=GetSkfDataParameterAndAllreadyDevice(e,t);var i=JointSendData(r,n);return sendAjaxData("NSSm2SkfGenContainerECCKeyPair","POST",i,a,JSCallbackRsaCspGenContainerP10)};e.IWSA_sm2_skf_ImportEncSM2EnvelopedKey=function(e,t,a,r){var n=GetSkfTitleParameterAndAllreadyDevice("PIN","Container","EncPrikey");var i=GetSkfDataParameterAndAllreadyDevice(e,t,a);var S=JointSendData(n,i);return sendAjaxData("NSSm2SkfImportEncSM2EnvelopedKey","POST",S,r,JSCallbackErrorCode)};e.IWSABigFileDetachedSign=function(e,t,a,r){a=GetDigestArithmeticByName(a);if(e!=""){e=GetPlanTextForConvertMode(e)}var n=["mypluginName=","&FilePathName=","&CertIndex=","&DigestArithmetic="];var i=[strwebSignDLL,e,t,a];var S=JointSendData(n,i);return sendAjaxData("NSBigFileDetachedSign","POST",S,r,JSCallbackNSSigned)};e.IWSABigFileDetachedVerify=function(e,t,a){e=BASE64URLEN(e);if(t!=""){t=GetPlanTextForConvertMode(t)}var r=["mypluginName=","&signedMsg=","&FilePathName="];var n=[strwebSignDLL,e,t];var i=JointSendData(r,n);return sendAjaxData("NSBigFileDetachedVerify","POST",i,a,JSCallbackErrorCode)};e.IWSASKFBigFileDetachedSign=function(e,t,a,r,n){r=GetDigestArithmeticByName(r);if(e!=""){e=GetPlanTextForConvertMode(e)}var i=["mypluginName=","&FilePathName=","&CertIndex=","&UsbKeyPin=","&DigestArithmetic="];var S=[strwebSignSKFDLL,e,t,a,r];var o=JointSendData(i,S);return sendAjaxData("NSSKFBigFileDetachedSign","POST",o,n,JSCallbackNSSigned)};e.IWSABigFileDetachedSignDefaultDN=function(e,t,a,r,n){r=GetDigestArithmeticByName(r);if(e!=""){e=GetPlanTextForConvertMode(e)}var i=InfosecGetCertStoreName("","Sign");var S="";if(a=="1"){S="2"}if(a=="0"){S="0"}var o=["mypluginName=","&FilePathName=","&CertStore=","&defultDN=","&Keyspec=","&DigestArithmetic="];var l=[strwebSignDLL,e,i,t,S,r];var s=JointSendData(o,l);return sendAjaxData("NSBigFileDetachedSignDefaultDN","POST",s,n,JSCallbackNSSigned)};e.IWSALoadDLL=function(e,t){var a=["mypluginName=","&dllPathName="];var r=[strWebExtendDllDLL,e];var n=JointSendData(a,r);return sendAjaxData("NSLoadExtendDLL","POST",n,t,JSCallbackErrorCode)};e.IWSAFreeDLL=function(e){var t="mypluginName="+strWebExtendDllDLL;return sendAjaxData("NSFreeExtendDLL","GET",t,e,JSCallbackErrorCode)};e.IWSAStdCallDLLFuncParameterZero=function(e,t){var a=["mypluginName=","&dllFuncName="];var r=[strWebExtendDllDLL,e];var n=JointSendData(a,r);return sendAjaxData("NSStdCallDLLFuncParameterZero","POST",n,t,JSCallbackErrorCode)};e.IWSAStdCallDLLFuncParameterOutCPtrOne=function(e,t,a){var r=["mypluginName=","&dllFuncName=","&OutCharLen="];var n=[strWebExtendDllDLL,e,t];var i=JointSendData(r,n);return sendAjaxData("NSStdCallDLLFuncParameterOutCPtrOne","POST",i,a,JSCallbackGetDataParem)};e.IWSAStdCallDLLFuncTwoParameter=function(e,t,a,r){var n=["mypluginName=","&dllFuncName=","&strParameter1=","&strParameter2="];var i=[strWebExtendDllDLL,e,t,a];var S=JointSendData(n,i);return sendAjaxData("NSStdCallDLLFuncTwoParameter","POST",S,r,JSCallbackErrorCode)};e.IWSAStdCallDLLFuncTwoParameterOutCPtrOne=function(e,t,a){var r=["mypluginName=","&dllFuncName=","&strParameter1="];var n=[strWebExtendDllDLL,e,t];var i=JointSendData(r,n);return sendAjaxData("NSStdCallDLLFuncTwoParameterOutCPtrOne","POST",i,a,JSCallbackGetDataParem)};e.IWSAStdCallDLLFuncFourParameterOutCPtrOne=function(e,t,a,r,n){var i=["mypluginName=","&dllFuncName=","&strParameter1=","&strParameter2=","&strParameter3="];var S=[strWebExtendDllDLL,e,t,a,r];var o=JointSendData(i,S);return sendAjaxData("NSStdCallDLLFuncFourParameterOutCPtrOne","POST",o,n,JSCallbackGetDataParem)};e.IWSACallDLLFuncParameterZero=function(e,t){var a=["mypluginName=","&dllFuncName="];var r=[strWebExtendDllDLL,e];var n=JointSendData(a,r);return sendAjaxData("NSCallDLLFuncParameterZero","POST",n,t,JSCallbackErrorCode)};e.IWSACallDLLFuncParameterOutCPtrOne=function(e,t,a){var r=["mypluginName=","&dllFuncName=","&OutCharLen="];var n=[strWebExtendDllDLL,e,t];var i=JointSendData(r,n);return sendAjaxData("NSCallDLLFuncParameterOutCPtrOne","POST",i,a,JSCallbackGetDataParem)};e.IWSACallDLLFuncTwoParameter=function(e,t,a,r){var n=["mypluginName=","&dllFuncName=","&strParameter1=","&strParameter2="];var i=[strWebExtendDllDLL,e,t,a];var S=JointSendData(n,i);return sendAjaxData("NSCallDLLFuncTwoParameter","POST",S,r,JSCallbackErrorCode)};e.IWSACallDLLFuncTwoParameterOutCPtrOne=function(e,t,a){var r=["mypluginName=","&dllFuncName=","&strParameter1="];var n=[strWebExtendDllDLL,e,t];var i=JointSendData(r,n);return sendAjaxData("NSCallDLLFuncTwoParameterOutCPtrOne","POST",i,a,JSCallbackGetDataParem)};e.IWSACallDLLFuncFourParameterOutCPtrOne=function(e,t,a,r,n){var i=["mypluginName=","&dllFuncName=","&strParameter1=","&strParameter2=","&strParameter3="];var S=[strWebExtendDllDLL,e,t,a,r];var o=JointSendData(i,S);return sendAjaxData("NSCallDLLFuncFourParameterOutCPtrOne","POST",o,n,JSCallbackGetDataParem)};e.IWSASkfGetCertsListInfoDIY=function(e,t){var a=["mypluginName=","&DllFilePath="];var r=[strwebSignSKFDLL,e];var n=JointSendData(a,r);return sendAjaxData("NSSkfGetCertsListInfo","POST",n,t,JSCallbackSkfGetCertsListInfo)};e.IWSASkfRawSignDIY=function(e,t,a,r,n){if(e!=""){e=GetPlanTextForConvertMode(e)}var i=["mypluginName=","&PlainText=","&CertIndex=","&UsbKeyPin=","&DigestArithmetic="];var S=[strwebSignSKFDLL,e,t,a,r];var o=JointSendData(i,S);return sendAjaxData("NSSkfRawSign","POST",o,n,JSCallbackNSSigned)};e.IWSASkfGetCertInfoForIndex=function(e,t){var a=["mypluginName=","&CertIndex="];var r=[strwebSignSKFDLL,e];var n=JointSendData(a,r);return sendAjaxData("NSSkfGetCertInfoForIndex","POST",n,t,JSCallbackGetCertInfoForIndex)};e.IWSASkfGetCertPublicKeyInfoForIndex=function(e,t){var a=["mypluginName=","&CertIndex="];var r=[strwebSignSKFDLL,e];var n=JointSendData(a,r);return sendAjaxData("NSSkfGetCertPublicKeyInfoForIndex","POST",n,t,JSCallbackGetCertPublicKeyInfoForIndex)};e.IWSABigFileHash=function(e,t,a){if(e!=""){e=GetPlanTextForConvertMode(e)}var r=["mypluginName=","&FilePathName=","&DigestArithmetic="];var n=[strwebSignDLL,e,t];var i=JointSendData(r,n);return sendAjaxData("NSBigFileHash","POST",i,a,JSCallbackBigFileHash)};e.IWSACALLDLLFunction=function(e,t){var a=["mypluginName=","&strText="];var r=[strWebExtendDllDLL,e];var n=JointSendData(a,r);return sendAjaxData("NSCallDLLFunction","POST",n,t,JSCallbackCallDLLFunction)};e.IWSAAddLicense=function(e,t){var a=["strText="];var r=[e];var n=JointSendData(a,r);return sendAjaxData("NSAddLicense","POST",n,t,JSCallbackErrorCode)};e.IWSAGetLicenseTime=function(e){return sendAjaxData("NSGetLicenseTime","GET","",e,JSCallbackGetLicenseTime)};e.IWSAAddCookie=function(e,t,a){var r=["Name=","&Value="];var n=[e,t];var i=JointSendData(r,n);return sendAjaxData("NSAddCookie","POST",i,a,JSCallbackErrorCode)};e.IWSAGetCookieCount=function(e){return sendAjaxData("NSGetCookieCount","GET","",e,JSCallbackGetCookieCount)};e.IWSADelCookieForName=function(e,t){var a=["Name="];var r=[e];var n=JointSendData(a,r);return sendAjaxData("NSDelCookieForName","POST",n,t,JSCallbackErrorCode)};e.IWSAGetCookieNameForIndex=function(e,t){var a=["Index="];var r=[e];var n=JointSendData(a,r);return sendAjaxData("NSGetCookieNameForIndex","POST",n,t,JSCallbackGetCookieCount)};e.IWSAGetCookieValueForIndex=function(e,t){var a=["Index="];var r=[e];var n=JointSendData(a,r);return sendAjaxData("NSGetCookieValueForIndex","POST",n,t,JSCallbackGetCookieCount)};e.IWSAGetCookieValueForName=function(e,t){var a=["Name="];var r=[e];var n=JointSendData(a,r);return sendAjaxData("NSGetCookieValueForName","POST",n,t,JSCallbackGetCookieCount)};e.IWSASkfGetFileNameList=function(e,t){var a=["mypluginName=","&DllFilePath="];var r=[strwebSignSKFDLL,e];var n=JointSendData(a,r);return sendAjaxData("NSSkfGetFileNameList","POST",n,t,JSCallbackSkfGetFileNameList)};e.IWSASkfGetFileInfoForIndex=function(e,t,a){var r=["mypluginName=","&DllFilePath=","&Index="];var n=[strwebSignSKFDLL,e,t];var i=JointSendData(r,n);return sendAjaxData("NSSkfGetFileInfoForIndex","POST",i,a,JSCallbackSkfGetFileInfoForIndex)};e.IWSASkfGetMACforSM2PublickeyEncrypt=function(e,t){e=BASE64URLEN(e);var a=["mypluginName=","&SM2Publickey="];var r=[strwebSignSKFDLL,e];var n=JointSendData(a,r);return sendAjaxData("NSSkfGetMACforSM2PublickeyEncrypt","POST",n,t,JSCallbackBase64Encode)};e.IWSA_sm2_skf_InitKeyApplicationFT=function(e,t,a,r,n,i){var S=["mypluginName=","&Provider=","&Device=","&AppName=","&AdminPin=","&UserPin="];var o=[strwebEnrollSM2SKFDLL,e,t,a,r,n];var l=JointSendData(S,o);return sendAjaxData("NSSm2SkfInitKeyApplicationFT","POST",l,i,JSCallbackErrorCode)};e.IWSA_sm2_skf_CheckDefaultPIN=function(e){var t=GetSkfTitleParameterAndAllreadyDevice();var a=GetSkfDataParameterAndAllreadyDevice();var r=JointSendData(t,a);return sendAjaxData("NSSm2SkfCheckDefaultPIN","POST",r,e,JSCallbackGetDataParem)};e.IWSA_sm2_skf_ChangePin=function(e,t,a){var r=GetSkfTitleParameterAndAllreadyDevice("OldPin","NewPin");var n=GetSkfDataParameterAndAllreadyDevice(e,t);var i=JointSendData(r,n);return sendAjaxData("NSSm2SkfChangePin","POST",i,a,JSCallbackGetDataParem)};e.IWSA_RSA_skf_genContainerP10=function(e,t,a,r,n,i){var S=GetSkfTitleParameterAndAllreadyDevice("delContainer","PIN","KeySize","DN","Digest");var o=GetSkfDataParameterAndAllreadyDevice(e,t,a,r,n);var l=JointSendData(S,o);return sendAjaxData("NSSm2SkfGenContainerP10RSA","POST",l,i,JSCallbackRsaCspGenContainerP10)};e.IWSA_RSA_skf_importSignX509Cert=function(e,t,a,r){var n=GetSkfTitleParameterAndAllreadyDevice("PIN","Container","X509Cert");var i=GetSkfDataParameterAndAllreadyDevice(e,t,a);var S=JointSendData(n,i);return sendAjaxData("NSSm2SkfImportSignX509CertRSA","POST",S,r,JSCallbackErrorCode)};e.IWSA_MAuth_SDK_GetVersion=function(e){return sendAjaxData("NSMAuthSDKGetVersion","GET","",e,JSCallbackGetVersion)};e.IWSA_MAuth_SDK_KeyStore_new=function(e,t,a){var r=["username=","&pin="];var n=[e,t];var i=JointSendData(r,n);return sendAjaxData("NSMAuthSDKKeyStoreNew","POST",i,a,JSCallbackErrorCode)};e.IWSA_MAuth_SDK_KeyStore_free=function(e){return sendAjaxData("NSMAuthSDKKeyStorefree","GET","",e,JSCallbackErrorCode)};e.IWSA_MAuth_SDK_KeyStore_data_check=function(e,t,a,r,n,i){var S=["keypair_type=","&keypair_usage=","&keypair_strength=","&data_type=","&strPin="];var o=[e,t,a,r,n];var l=JointSendData(S,o);return sendAjaxData("NSMAuthSDKKeyStoredatacheck","POST",l,i,JSCallbackErrorCode)};e.IWSA_MAuth_SDK_KeyStore_data_import=function(e,t,a,r,n,i,S){var o=["keypair_type=","&keypair_usage=","&keypair_strength=","&data_type=","&strPin=","&data="];var l=[e,t,a,r,n,i];var s=JointSendData(o,l);return sendAjaxData("NSMAuthSDKKeyStoredataimport","POST",s,S,JSCallbackErrorCode)};e.IWSA_MAuth_SDK_KeyStore_data_export=function(e,t,a,r,n,i){var S=["keypair_type=","&keypair_usage=","&keypair_strength=","&data_type=","&strPin="];var o=[e,t,a,r,n];var l=JointSendData(S,o);return sendAjaxData("NSMAuthSDKKeyStoredataexport","POST",l,i,JSCallbackGetDataParem)};e.IWSA_MAuth_SDK_KeyStore_data_export_mauth=function(e,t,a,r,n,i){var S=["keypair_type=","&keypair_usage=","&keypair_strength=","&data_type=","&strPin="];var o=[e,t,a,r,n];var l=JointSendData(S,o);return sendAjaxData("NSMAuthSDKKeyStoredataexportmauth","POST",l,i,JSCallbackGetDataParem)};e.IWSA_MAuth_SDK_KeyStore_data_delete=function(e,t,a,r,n){var i=["keypair_type=","&keypair_usage=","&keypair_strength=","&data_type="];var S=[e,t,a,r];var o=JointSendData(i,S);return sendAjaxData("NSMAuthSDKKeyStoredatadelete","POST",o,n,JSCallbackErrorCode)};e.IWSA_MAuth_SDK_KeyStore_gen_keypair=function(e,t,a,r,n){var i=["keypair_type=","&keypair_usage=","&keypair_strength=","&strPin="];var S=[e,t,a,r];var o=JointSendData(i,S);return sendAjaxData("NSMAuthSDKKeyStoregenkeypair","POST",o,n,JSCallbackErrorCode)};e.IWSA_MAuth_SDK_KeyStore_gen_csr=function(e,t,a,r,n,i,S){var o=["keypair_type=","&keypair_usage=","&keypair_strength=","&hash=","&CertDN=","&strPin="];var l=[e,t,a,r,n,i];var s=JointSendData(o,l);return sendAjaxData("NSMAuthSDKKeyStoregencsr","POST",s,S,JSCallbackGetDataParem)};e.IWSA_MAuth_SDK_KeyStore_sign=function(e,t,a,r,n,i,S,o){var l=["keypair_type=","&keypair_usage=","&keypair_strength=","&hash=","&SignType=","&strPin=","&plantText="];var s=[e,t,a,r,n,i,S];var c=JointSendData(l,s);return sendAjaxData("NSMAuthSDKKeyStoresign","POST",c,o,JSCallbackMAuthSDKGetBASE64URLData)};e.IWSA_MAuth_SDK_KeyStore_verify=function(e,t,a,r,n,i,S,o){S=BASE64URLEN(S);var l=["keypair_type=","&keypair_usage=","&keypair_strength=","&hash=","&SignType=","&plantText=","&SignMSG="];var s=[e,t,a,r,n,i,S];var c=JointSendData(l,s);return sendAjaxData("NSMAuthSDKKeyStoreverify","POST",c,o,JSCallbackErrorCode)};e.IWSA_MAuth_SDK_KeyStore_xtsign_signer_init=function(e,t){e=BASE64URLEN(e);var a=["data="];var r=[e];var n=JointSendData(a,r);return sendAjaxData("NSMAuthSDKKeyStorextsignsignerinit","POST",n,t,JSCallbackMAuthSDKGetBASE64URLData)};e.IWSA_MAuth_SDK_KeyStore_xtsign_cosigner_sign=function(e,t,a){t=BASE64URLEN(t);var r=["strPin=","&init_data="];var n=[e,t];var i=JointSendData(r,n);return sendAjaxData("NSMAuthSDKKeyStorextsigncosignersign","POST",i,a,JSCallbackMAuthSDKGetBASE64URLData)};e.IWSA_MAuth_SDK_KeyStore_xtsign_signer_sign=function(e,t,a,r,n){r=BASE64URLEN(r);var i=["sign_type=","&strPin=","&plain=","&init_sign="];var S=[e,t,a,r];var o=JointSendData(i,S);return sendAjaxData("NSMAuthSDKKeyStorextsignsignersign","POST",o,n,JSCallbackGetDataParem)};e.IWSA_MAuth_SDK_KeyStore_xtsign_free=function(e){return sendAjaxData("NSMAuthSDKKeyStorextsignfree","GET","",e,JSCallbackErrorCode)};e.IWSA_MAuth_SDK_KeyStore_gen_csr_plain=function(e,t,a,r,n,i){var S=["keypair_type=","&keypair_usage=","&keypair_strength=","&hash=","&CertDN="];var o=[e,t,a,r,n];var l=JointSendData(S,o);return sendAjaxData("NSMAuthSDKKeyStoregencsrplain","POST",l,i,JSCallbackMAuthSDKGetBASE64URLData)};e.IWSA_MAuth_SDK_KeyStore_merge_csr=function(e,t,a,r){e=BASE64URLEN(e);t=BASE64URLEN(t);var n=["csr_tbs=","&signMsg=","&hash="];var i=[e,t,a];var S=JointSendData(n,i);return sendAjaxData("NSMAuthSDKKeyStoremergecsr","POST",S,r,JSCallbackGetDataParem)};e.IWSA_MAuth_SDK_mauth_new=function(e,t,a,r,n,i,S,o,l,s){o=BASE64URLEN(o);var c=["mAuth_host=","&mAuth_port=","&username=","&strPin=","&appid=","&secret_key=","&SSL_PROTOCOL=","&ca_file=","&ca_path="];var u=[e,t,a,r,n,i,S,o,l];var d=JointSendData(c,u);return sendAjaxData("NSMAuthSDKmauthnew","POST",d,s,JSCallbackErrorCode)};e.IWSA_MAuth_SDK_mauth_free=function(e){return sendAjaxData("NSMAuthSDKmauthfree","GET","",e,JSCallbackErrorCode)};e.IWSA_MAuth_SDK_mauth_user_check_status=function(e){return sendAjaxData("NSMAuthSDKmauthusercheckstatus","GET","",e,JSCallbackErrorCode)};e.IWSA_MAuth_SDK_mauth_user_register=function(e){return sendAjaxData("NSMAuthSDKmauthuserregister","GET","",e,JSCallbackGetDataParem)};e.IWSA_MAuth_SDK_mauth_device_check_status=function(e){return sendAjaxData("NSMAuthSDKmauthdevicecheckstatus","GET","",e,JSCallbackErrorCode)};e.IWSA_MAuth_SDK_mauth_device_register=function(e,t){var a=["code="];var r=[e];var n=JointSendData(a,r);return sendAjaxData("NSMAuthSDKmauthdeviceregister","POST",n,t,JSCallbackErrorCode)};e.IWSA_MAuth_SDK_mauth_cert_check_status=function(e){return sendAjaxData("NSMAuthSDKmauthcertcheckstatus","GET","",e,JSCallbackErrorCode)};e.IWSA_MAuth_SDK_mauth_cert_download=function(e,t){var a=["strPin="];var r=[e];var n=JointSendData(a,r);return sendAjaxData("NSMAuthSDKmauthcertdownload","POST",n,t,JSCallbackErrorCode)};e.IWSA_MAuth_SDK_mauth_sign=function(e,t,a,r){var n=["sign_type=","&strPin=","&plantText="];var i=[e,t,a];var S=JointSendData(n,i);return sendAjaxData("NSMAuthSDKmauthsign","POST",S,r,JSCallbackMAuthSDKGetBASE64URLData)};e.IWSA_MAuth_SDK_mauth_verify=function(e,t,a,r){a=BASE64URLEN(a);var n=["sign_type=","&plantText=","&SignMSG="];var i=[e,t,a];var S=JointSendData(n,i);return sendAjaxData("NSMAuthSDKmauthverify","POST",S,r,JSCallbackErrorCode)};e.IWSASetRawSignIsAsn1Type=function(e,t){var a=["mypluginName=","&nType="];var r=[strwebSignDLL,e];var n=JointSendData(a,r);return sendAjaxData("NSSetRawSignIsAsn1","POST",n,t,JSCallbackErrorCode)};e.IWSASetRawVerifySignIstime=function(e,t){var a=["mypluginName=","&nType="];var r=[strwebSignDLL,e];var n=JointSendData(a,r);return sendAjaxData("NSRawVerifySignIsCertTime","POST",n,t,JSCallbackErrorCode)};e.IWSAiSec_get_version=function(e){var t="mypluginName="+strWebIsecDLL;return sendAjaxData("NSiSec_GetVersion","GET",t,e,JSCallbackGetDataParem)};e.IWSAiSec_strerror=function(e,t){var a=["mypluginName=","&strErr="];var r=[strWebIsecDLL,e];var n=JointSendData(a,r);return sendAjaxData("NSiSec_strerror","POST",n,t,JSCallbackGetCookieCount)};e.IWSAisec_crypto_base64_encode=function(e,t){var a=["mypluginName=","&strIn="];var r=[strWebIsecDLL,e];var n=JointSendData(a,r);return sendAjaxData("NSisec_crypto_base64_encode","POST",n,t,JSCallbackMAuthSDKGetBASE64URLData)};e.IWSAisec_crypto_base64_Decode=function(e,t){e=BASE64URLEN(e);var a=["mypluginName=","&strIn="];var r=[strWebIsecDLL,e];var n=JointSendData(a,r);return sendAjaxData("NSisec_crypto_base64_Decode","POST",n,t,JSCallbackCallDLLFunction)};e.IWSAisec_ke_new=function(e){var t="mypluginName="+strWebIsecDLL;return sendAjaxData("NSisec_ke_new","GET",t,e,JSCallbackGetDataParem)};e.IWSAisec_ke_free=function(e,t){var a=["mypluginName=","&strKe="];var r=[strWebIsecDLL,e];var n=JointSendData(a,r);return sendAjaxData("NSisec_ke_free","POST",n,t,JSCallbackErrorCode)};e.IWSAisec_ke_set_public_key=function(e,t,a,r,n){t=BASE64URLEN(t);t=BASE64URLEN(t);var i=["mypluginName=","&strKe=","&strSig_key=","&strEnc_key=","&strPassword="];var S=[strWebIsecDLL,e,t,a,r];var o=JointSendData(i,S);return sendAjaxData("NSisec_ke_set_public_key","POST",o,n,JSCallbackErrorCode)};e.IWSAisec_ke_set_certificate=function(e,t,a,r,n){t=BASE64URLEN(t);a=BASE64URLEN(a);var i=["mypluginName=","&strKe=","&strSig_cert=","&strEnc_cert=","&strPassword="];var S=[strWebIsecDLL,e,t,a,r];var o=JointSendData(i,S);return sendAjaxData("NSisec_ke_set_certificate","POST",o,n,JSCallbackErrorCode)};e.IWSAisec_ke_set_root_certificate=function(e,t,a,r){var n=["mypluginName=","&strKe=","&strCa_file=","&strCa_path="];var i=[strWebIsecDLL,e,t,a];var S=JointSendData(n,i);return sendAjaxData("NSisec_ke_set_root_certificate","POST",S,r,JSCallbackErrorCode)};e.IWSAisec_ke_client_hello=function(e,t){var a=["mypluginName=","&strKe="];var r=[strWebIsecDLL,e];var n=JointSendData(a,r);return sendAjaxData("NSisec_ke_client_hello","POST",n,t,JSCallbackMAuthSDKGetBASE64URLData)};e.IWSACisec_ke_client_key_exchange=function(e,t,a,r,n,i){t=BASE64URLEN(t);a=BASE64URLEN(a);r=BASE64URLEN(r);n=BASE64URLEN(n);var S=["mypluginName=","&strKe=","&strSrvr_rand=","&strSrvr_sig_cert=","&strSrvr_enc_cert=","&strSrvr_sign="];var o=[strWebIsecDLL,e,t,a,r,n];var l=JointSendData(S,o);return sendAjaxData("NSisec_ke_client_key_exchange","POST",l,i,JSCallbackMAuthSDKGetBASE64URLData)};e.IWSAisec_ke_encrypt=function(e,t,a){t=BASE64URLEN(t);var r=["mypluginName=","&strKe=","&strdata="];var n=[strWebIsecDLL,e,t];var i=JointSendData(r,n);return sendAjaxData("NSisec_ke_encrypt","POST",i,a,JSCallbackMAuthSDKGetBASE64URLData)};e.IWSAisec_ke_decrypt=function(e,t,a){t=BASE64URLEN(t);var r=["mypluginName=","&strKe=","&strcipher="];var n=[strWebIsecDLL,e,t];var i=JointSendData(r,n);return sendAjaxData("NSisec_ke_decrypt","POST",i,a,JSCallbackMAuthSDKGetBASE64URLData)};e.IWSAisec_ke_hmac=function(e,t,a){t=BASE64URLEN(t);var r=["mypluginName=","&strKe=","&strdata="];var n=[strWebIsecDLL,e,t];var i=JointSendData(r,n);return sendAjaxData("NSisec_ke_hmac","POST",i,a,JSCallbackMAuthSDKGetBASE64URLData)};e.IWSAisec_ke_cmac=function(e,t,a){t=BASE64URLEN(t);var r=["mypluginName=","&strKe=","&strdata="];var n=[strWebIsecDLL,e,t];var i=JointSendData(r,n);return sendAjaxData("NSisec_ke_cmac","POST",i,a,JSCallbackMAuthSDKGetBASE64URLData)};return e}